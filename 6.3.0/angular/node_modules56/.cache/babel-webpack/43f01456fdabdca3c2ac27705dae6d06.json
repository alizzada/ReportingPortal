{"ast":null,"code":"/**\r\n * DevExtreme (esm/viz/tree_map/tiling.squarified.base.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nvar _max = Math.max;\nvar _round = Math.round;\nimport { buildSidesData, calculateRectangles, getStaticSideIndex } from \"./tiling\";\n\nfunction compare(a, b) {\n  return b.value - a.value;\n}\n\nfunction getAspectRatio(value) {\n  return _max(value, 1 / value);\n}\n\nfunction findAppropriateCollection(nodes, head, context) {\n  var bestAspectRatio = 1 / 0;\n  var nextAspectRatio;\n  var sum = 0;\n  var nextSum;\n  var i;\n  var j;\n  var ii = nodes.length;\n  var coeff = context.areaToValue / context.staticSide;\n  var totalAspectRatio;\n\n  for (i = head; i < ii;) {\n    nextSum = sum + nodes[i].value;\n    totalAspectRatio = context.staticSide / coeff / nextSum;\n    nextAspectRatio = 0;\n\n    for (j = head; j <= i; ++j) {\n      nextAspectRatio = context.accumulate(nextAspectRatio, getAspectRatio(totalAspectRatio * nodes[j].value / nextSum), j - head + 1);\n    }\n\n    if (nextAspectRatio < bestAspectRatio) {\n      bestAspectRatio = nextAspectRatio;\n      sum = nextSum;\n      ++i;\n    } else {\n      break;\n    }\n  }\n\n  return {\n    sum: sum,\n    count: i - head,\n    side: _round(coeff * sum)\n  };\n}\n\nfunction getArea(rect) {\n  return (rect[2] - rect[0]) * (rect[3] - rect[1]);\n}\n\nfunction doStep(nodes, head, context) {\n  var sidesData = buildSidesData(context.rect, context.directions, context.staticSideIndex);\n  var area = getArea(context.rect);\n  var rowData = area > 0 ? findAppropriateCollection(nodes, head, {\n    areaToValue: area / context.sum,\n    accumulate: context.accumulate,\n    staticSide: sidesData.staticSide\n  }) : {\n    sum: 1,\n    side: sidesData.variedSide,\n    count: nodes.length - head\n  };\n  calculateRectangles(nodes, head, context.rect, sidesData, rowData);\n  context.sum -= rowData.sum;\n  return head + rowData.count;\n}\n\nexport default function (data, accumulate, isFixedStaticSide) {\n  var items = data.items;\n  var ii = items.length;\n  var i;\n  var context = {\n    sum: data.sum,\n    rect: data.rect,\n    directions: data.directions,\n    accumulate: accumulate\n  };\n\n  if (isFixedStaticSide) {\n    context.staticSideIndex = getStaticSideIndex(context.rect);\n  }\n\n  items.sort(compare);\n\n  for (i = 0; i < ii;) {\n    i = doStep(items, i, context);\n  }\n}","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/viz/tree_map/tiling.squarified.base.js"],"names":["_max","Math","max","_round","round","buildSidesData","calculateRectangles","getStaticSideIndex","compare","a","b","value","getAspectRatio","findAppropriateCollection","nodes","head","context","bestAspectRatio","nextAspectRatio","sum","nextSum","i","j","ii","length","coeff","areaToValue","staticSide","totalAspectRatio","accumulate","count","side","getArea","rect","doStep","sidesData","directions","staticSideIndex","area","rowData","variedSide","data","isFixedStaticSide","items","sort"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/viz/tree_map/tiling.squarified.base.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nvar _max = Math.max;\r\nvar _round = Math.round;\r\nimport {\r\n    buildSidesData,\r\n    calculateRectangles,\r\n    getStaticSideIndex\r\n} from \"./tiling\";\r\n\r\nfunction compare(a, b) {\r\n    return b.value - a.value\r\n}\r\n\r\nfunction getAspectRatio(value) {\r\n    return _max(value, 1 / value)\r\n}\r\n\r\nfunction findAppropriateCollection(nodes, head, context) {\r\n    var bestAspectRatio = 1 / 0;\r\n    var nextAspectRatio;\r\n    var sum = 0;\r\n    var nextSum;\r\n    var i;\r\n    var j;\r\n    var ii = nodes.length;\r\n    var coeff = context.areaToValue / context.staticSide;\r\n    var totalAspectRatio;\r\n    for (i = head; i < ii;) {\r\n        nextSum = sum + nodes[i].value;\r\n        totalAspectRatio = context.staticSide / coeff / nextSum;\r\n        nextAspectRatio = 0;\r\n        for (j = head; j <= i; ++j) {\r\n            nextAspectRatio = context.accumulate(nextAspectRatio, getAspectRatio(totalAspectRatio * nodes[j].value / nextSum), j - head + 1)\r\n        }\r\n        if (nextAspectRatio < bestAspectRatio) {\r\n            bestAspectRatio = nextAspectRatio;\r\n            sum = nextSum;\r\n            ++i\r\n        } else {\r\n            break\r\n        }\r\n    }\r\n    return {\r\n        sum: sum,\r\n        count: i - head,\r\n        side: _round(coeff * sum)\r\n    }\r\n}\r\n\r\nfunction getArea(rect) {\r\n    return (rect[2] - rect[0]) * (rect[3] - rect[1])\r\n}\r\n\r\nfunction doStep(nodes, head, context) {\r\n    var sidesData = buildSidesData(context.rect, context.directions, context.staticSideIndex);\r\n    var area = getArea(context.rect);\r\n    var rowData = area > 0 ? findAppropriateCollection(nodes, head, {\r\n        areaToValue: area / context.sum,\r\n        accumulate: context.accumulate,\r\n        staticSide: sidesData.staticSide\r\n    }) : {\r\n        sum: 1,\r\n        side: sidesData.variedSide,\r\n        count: nodes.length - head\r\n    };\r\n    calculateRectangles(nodes, head, context.rect, sidesData, rowData);\r\n    context.sum -= rowData.sum;\r\n    return head + rowData.count\r\n}\r\nexport default function(data, accumulate, isFixedStaticSide) {\r\n    var items = data.items;\r\n    var ii = items.length;\r\n    var i;\r\n    var context = {\r\n        sum: data.sum,\r\n        rect: data.rect,\r\n        directions: data.directions,\r\n        accumulate: accumulate\r\n    };\r\n    if (isFixedStaticSide) {\r\n        context.staticSideIndex = getStaticSideIndex(context.rect)\r\n    }\r\n    items.sort(compare);\r\n    for (i = 0; i < ii;) {\r\n        i = doStep(items, i, context)\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}