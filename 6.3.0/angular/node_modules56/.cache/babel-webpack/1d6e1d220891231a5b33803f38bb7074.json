{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/scheduler/header/navigator.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../../core/renderer\";\nimport { noop } from \"../../../core/utils/common\";\nimport { isNumeric, isDefined, isFunction } from \"../../../core/utils/type\";\nimport errors from \"../../widget/ui.errors\";\nimport dateUtils from \"../../../core/utils/date\";\nimport { extend } from \"../../../core/utils/extend\";\nimport registerComponent from \"../../../core/component_registrator\";\nimport devices from \"../../../core/devices\";\nimport Widget from \"../../widget/ui.widget\";\nimport Button from \"../../button\";\nimport Calendar from \"../../calendar\";\nimport Popover from \"../../popover\";\nimport Popup from \"../../popup\";\nimport publisherMixin from \"../publisher_mixin\";\nimport dateLocalization from \"../../../localization/date\";\nimport Scrollable from \"../../scroll_view/ui.scrollable\";\nvar ELEMENT_CLASS = \"dx-scheduler-navigator\";\nvar CALENDAR_CLASS = \"dx-scheduler-navigator-calendar\";\nvar NEXT_BUTTON_CLASS = \"dx-scheduler-navigator-next\";\nvar CAPTION_BUTTON_CLASS = \"dx-scheduler-navigator-caption\";\nvar PREVIOUS_BUTTON_CLASS = \"dx-scheduler-navigator-previous\";\nvar CALENDAR_POPOVER_CLASS = \"dx-scheduler-navigator-calendar-popover\";\nvar MONDAY_INDEX = 1;\n\nvar getDefaultFirstDayOfWeekIndex = function getDefaultFirstDayOfWeekIndex(shift) {\n  return shift ? MONDAY_INDEX : dateLocalization.firstDayOfWeekIndex();\n};\n\nvar getDateMonthFormat = function getDateMonthFormat(short) {\n  return function (date) {\n    var monthName = dateLocalization.getMonthNames(short ? \"abbreviated\" : \"wide\")[date.getMonth()];\n    return [dateLocalization.format(date, \"day\"), monthName].join(\" \");\n  };\n};\n\nvar getMonthYearFormat = function getMonthYearFormat(date) {\n  return dateLocalization.getMonthNames(\"abbreviated\")[date.getMonth()] + \" \" + dateLocalization.format(date, \"year\");\n};\n\nvar getCaptionFormat = function getCaptionFormat(short, intervalCount, duration) {\n  var dateMonthFormat = getDateMonthFormat(short);\n  return function (date) {\n    if (intervalCount > 1) {\n      var lastIntervalDate = new Date(date);\n      var defaultViewDuration = duration;\n      lastIntervalDate.setDate(date.getDate() + defaultViewDuration - 1);\n      var isDifferentMonthDates = date.getMonth() !== lastIntervalDate.getMonth();\n      var useShortFormat = isDifferentMonthDates || short;\n      var firstWeekDateText = dateLocalization.format(date, isDifferentMonthDates ? getDateMonthFormat(useShortFormat) : \"d\");\n      var lastWeekDateText = dateLocalization.format(lastIntervalDate, getCaptionFormat(useShortFormat));\n      return firstWeekDateText + \"-\" + lastWeekDateText;\n    }\n\n    return [dateMonthFormat(date), dateLocalization.format(date, \"year\")].join(\" \");\n  };\n};\n\nvar getWeekCaption = function getWeekCaption(date, shift, rejectWeekend) {\n  var firstDayOfWeek = this.option(\"firstDayOfWeek\");\n  var firstDayOfWeekIndex = isDefined(firstDayOfWeek) ? firstDayOfWeek : getDefaultFirstDayOfWeekIndex(shift);\n\n  if (0 === firstDayOfWeekIndex && rejectWeekend) {\n    firstDayOfWeekIndex = MONDAY_INDEX;\n  }\n\n  var firstWeekDate = dateUtils.getFirstWeekDate(date, firstDayOfWeekIndex);\n\n  if (rejectWeekend) {\n    firstWeekDate = dateUtils.normalizeDateByWeek(firstWeekDate, date);\n  }\n\n  if (firstDayOfWeek >= 6 && rejectWeekend) {\n    firstWeekDate.setDate(firstWeekDate.getDate() + (7 - firstDayOfWeek + 1));\n  }\n\n  var lastWeekDate = new Date(firstWeekDate);\n  var intervalCount = this.option(\"intervalCount\");\n  shift = shift || 6;\n  lastWeekDate = new Date(lastWeekDate.setDate(lastWeekDate.getDate() + (intervalCount > 1 ? 7 * (intervalCount - 1) + shift : shift)));\n\n  if (lastWeekDate.getDay() % 6 === 0 && rejectWeekend) {\n    lastWeekDate.setDate(lastWeekDate.getDate() + 2);\n  }\n\n  return {\n    text: formatCaptionByMonths.call(this, lastWeekDate, firstWeekDate),\n    startDate: firstWeekDate,\n    endDate: lastWeekDate\n  };\n};\n\nvar formatCaptionByMonths = function formatCaptionByMonths(lastDate, firstDate) {\n  var isDifferentMonthDates = firstDate.getMonth() !== lastDate.getMonth();\n  var isDifferentYears = firstDate.getFullYear() !== lastDate.getFullYear();\n  var useShortFormat = isDifferentMonthDates || this.option(\"_useShortDateFormat\");\n  var lastDateText;\n  var firstDateText;\n\n  if (isDifferentYears) {\n    firstDateText = dateLocalization.format(firstDate, getCaptionFormat(true));\n    lastDateText = dateLocalization.format(lastDate, getCaptionFormat(true));\n  } else {\n    firstDateText = dateLocalization.format(firstDate, isDifferentMonthDates ? getDateMonthFormat(useShortFormat) : \"d\");\n    lastDateText = dateLocalization.format(lastDate, getCaptionFormat(useShortFormat));\n  }\n\n  return firstDateText + \"-\" + lastDateText;\n};\n\nvar getMonthCaption = function getMonthCaption(date) {\n  var firstDate = new Date(dateUtils.getFirstMonthDate(date));\n  var lastDate = new Date(dateUtils.getLastMonthDate(firstDate));\n  var text;\n\n  if (this.option(\"intervalCount\") > 1) {\n    lastDate = new Date(firstDate);\n    lastDate.setMonth(firstDate.getMonth() + this.option(\"intervalCount\") - 1);\n    lastDate = new Date(dateUtils.getLastMonthDate(lastDate));\n    var isSameYear = firstDate.getYear() === lastDate.getYear();\n    var lastDateText = getMonthYearFormat(lastDate);\n    var firstDateText = isSameYear ? dateLocalization.getMonthNames(\"abbreviated\")[firstDate.getMonth()] : getMonthYearFormat(firstDate);\n    text = firstDateText + \"-\" + lastDateText;\n  } else {\n    text = dateLocalization.format(date, \"monthandyear\");\n  }\n\n  return {\n    text: text,\n    startDate: firstDate,\n    endDate: lastDate\n  };\n};\n\nvar dateGetter = function dateGetter(date, offset) {\n  return new Date(date[this.setter](date[this.getter]() + offset));\n};\n\nvar getConfig = function getConfig(step) {\n  var agendaDuration;\n\n  switch (step) {\n    case \"day\":\n      return {\n        duration: 1 * this.option(\"intervalCount\"),\n        setter: \"setDate\",\n        getter: \"getDate\",\n        getDate: dateGetter,\n        getCaption: function getCaption(date) {\n          var format = getCaptionFormat(false, this.option(\"intervalCount\"), this._getConfig().duration);\n          return {\n            text: dateLocalization.format(date, format),\n            startDate: date,\n            endDate: date\n          };\n        }\n      };\n\n    case \"week\":\n      return {\n        duration: 7 * this.option(\"intervalCount\"),\n        setter: \"setDate\",\n        getter: \"getDate\",\n        getDate: dateGetter,\n        getCaption: getWeekCaption\n      };\n\n    case \"workWeek\":\n      return {\n        duration: 7 * this.option(\"intervalCount\"),\n        setter: \"setDate\",\n        getter: \"getDate\",\n        getDate: dateGetter,\n        getCaption: function getCaption(date) {\n          return getWeekCaption.call(this, date, 4, true);\n        }\n      };\n\n    case \"month\":\n      return {\n        duration: 1 * this.option(\"intervalCount\"),\n        setter: \"setMonth\",\n        getter: \"getMonth\",\n        getDate: function getDate(date, offset) {\n          var currentDate = date.getDate();\n          date.setDate(1);\n          date = dateGetter.call(this, date, offset);\n          var lastDate = dateUtils.getLastMonthDay(date);\n          date.setDate(currentDate < lastDate ? currentDate : lastDate);\n          return date;\n        },\n        getCaption: getMonthCaption\n      };\n\n    case \"agenda\":\n      agendaDuration = this.invoke(\"getAgendaDuration\");\n      agendaDuration = isNumeric(agendaDuration) && agendaDuration > 0 ? agendaDuration : 7;\n      return {\n        duration: agendaDuration,\n        setter: \"setDate\",\n        getter: \"getDate\",\n        getDate: dateGetter,\n        getCaption: function getCaption(date) {\n          var format = getCaptionFormat(this.option(\"_useShortDateFormat\"));\n          var firstDate = new Date(date);\n          var lastDate = new Date(date);\n          var text;\n\n          if (agendaDuration > 1) {\n            lastDate.setDate(lastDate.getDate() + agendaDuration - 1);\n            text = formatCaptionByMonths.call(this, lastDate, date);\n          } else {\n            text = dateLocalization.format(date, format);\n          }\n\n          return {\n            text: text,\n            startDate: firstDate,\n            endDate: lastDate\n          };\n        }\n      };\n  }\n};\n\nexport var Navigator = Widget.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      date: new Date(),\n      displayedDate: void 0,\n      step: \"day\",\n      intervalCount: 1,\n      min: void 0,\n      max: void 0,\n      firstDayOfWeek: void 0,\n      _useShortDateFormat: false,\n      todayDate: function todayDate() {\n        return new Date();\n      }\n    });\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    return this.callBase().concat([{\n      device: function device() {\n        return !devices.real().generic || devices.isSimulator();\n      },\n      options: {\n        _useShortDateFormat: true\n      }\n    }]);\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"step\":\n      case \"date\":\n      case \"intervalCount\":\n      case \"displayedDate\":\n        this._updateButtonsState();\n\n        this._renderCaption();\n\n        this._setCalendarOption(\"value\", this.option(\"date\"));\n\n        break;\n\n      case \"min\":\n      case \"max\":\n        this._updateButtonsState();\n\n        this._setCalendarOption(args.name, args.value);\n\n        break;\n\n      case \"firstDayOfWeek\":\n        this._setCalendarOption(args.name, args.value);\n\n        break;\n\n      case \"customizeDateNavigatorText\":\n        this._renderCaption();\n\n        break;\n\n      case \"tabIndex\":\n      case \"focusStateEnabled\":\n        this._next.option(args.name, args.value);\n\n        this._caption.option(args.name, args.value);\n\n        this._prev.option(args.name, args.value);\n\n        this._setCalendarOption(args.name, args.value);\n\n        this.callBase(args);\n        break;\n\n      case \"_useShortDateFormat\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _init: function _init() {\n    this.callBase();\n    this.$element().addClass(ELEMENT_CLASS);\n\n    this._initButtons();\n  },\n  _initButtons: function _initButtons() {\n    var $next = $(\"<div>\").addClass(NEXT_BUTTON_CLASS);\n    this._next = this._createComponent($next, Button, {\n      icon: \"chevronnext\",\n      onClick: this._updateCurrentDate.bind(this, 1),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      tabIndex: this.option(\"tabIndex\"),\n      integrationOptions: {}\n    });\n    var $caption = $(\"<div>\").addClass(CAPTION_BUTTON_CLASS);\n    this._caption = this._createComponent($caption, Button, {\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      tabIndex: this.option(\"tabIndex\"),\n      integrationOptions: {}\n    });\n    var $prev = $(\"<div>\").addClass(PREVIOUS_BUTTON_CLASS);\n    this._prev = this._createComponent($prev, Button, {\n      icon: \"chevronprev\",\n      onClick: this._updateCurrentDate.bind(this, -1),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      tabIndex: this.option(\"tabIndex\"),\n      integrationOptions: {}\n    });\n    this.setAria(\"label\", \"Next period\", $next);\n    this.setAria(\"label\", \"Previous period\", $prev);\n\n    this._updateButtonsState();\n\n    this.$element().append($prev, $caption, $next);\n  },\n  _updateButtonsState: function _updateButtonsState() {\n    var min = this.option(\"min\");\n    var max = this.option(\"max\");\n\n    var caption = this._getConfig().getCaption.call(this, this.option(\"displayedDate\") || this.option(\"date\"));\n\n    min = min ? dateUtils.trimTime(min) : min;\n    max = max ? dateUtils.trimTime(max) : max;\n    max && max.setHours(23, 59, 59);\n\n    this._prev.option(\"disabled\", min && !isNaN(min.getTime()) && this._getNextDate(-1, caption.endDate) < min);\n\n    this._next.option(\"disabled\", max && !isNaN(max.getTime()) && this._getNextDate(1, caption.startDate) > max);\n  },\n  _updateCurrentDate: function _updateCurrentDate(direction) {\n    var date = this._getNextDate(direction);\n\n    dateUtils.normalizeDate(date, this.option(\"min\"), this.option(\"max\"));\n    this.notifyObserver(\"currentDateUpdated\", date);\n  },\n  _getNextDate: function _getNextDate(direction) {\n    var initialDate = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null;\n\n    var stepConfig = this._getConfig();\n\n    var offset = stepConfig.duration * direction;\n    var date = stepConfig.getDate(new Date(initialDate || this.option(\"date\")), offset);\n    return date;\n  },\n  _renderFocusTarget: noop,\n  _initMarkup: function _initMarkup() {\n    this.callBase();\n\n    this._renderCaption();\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderPopover();\n\n    this._renderCaptionKeys();\n  },\n  _isMobileLayout: function _isMobileLayout() {\n    return !devices.current().generic;\n  },\n  _renderPopover: function _renderPopover() {\n    var _this = this;\n\n    var overlayType = this._isMobileLayout() ? Popup : Popover;\n    var popoverContainer = $(\"<div>\").addClass(CALENDAR_POPOVER_CLASS);\n    this._popover = this._createComponent(popoverContainer, overlayType, {\n      contentTemplate: function contentTemplate() {\n        return _this._createPopupContent();\n      },\n      defaultOptionsRules: [{\n        device: function device() {\n          return !devices.current().generic;\n        },\n        options: {\n          fullScreen: true,\n          showCloseButton: false,\n          toolbarItems: [{\n            shortcut: \"cancel\"\n          }]\n        }\n      }, {\n        device: function device() {\n          return devices.current().generic;\n        },\n        options: {\n          target: this._caption.$element()\n        }\n      }]\n    });\n\n    this._popover.$element().appendTo(this.$element());\n  },\n  _createScrollable: function _createScrollable(content) {\n    var result = this._createComponent($(\"<div>\"), Scrollable, {\n      direction: \"vertical\"\n    });\n\n    result.$content().append(content);\n    return result;\n  },\n  _createPopupContent: function _createPopupContent() {\n    var result = $(\"<div>\").addClass(CALENDAR_CLASS);\n    this._calendar = this._createComponent(result, Calendar, this._calendarOptions());\n\n    if (this._isMobileLayout()) {\n      var scrollable = this._createScrollable(result);\n\n      return scrollable.$element();\n    }\n\n    return result;\n  },\n  _calendarOptions: function _calendarOptions() {\n    return {\n      min: this.option(\"min\"),\n      max: this.option(\"max\"),\n      firstDayOfWeek: this.option(\"firstDayOfWeek\"),\n      value: this.option(\"date\"),\n      _todayDate: this.option(\"todayDate\"),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      onValueChanged: function (e) {\n        if (!this.option(\"visible\")) {\n          return;\n        }\n\n        this.notifyObserver(\"currentDateUpdated\", e.value);\n\n        this._popover.hide();\n      }.bind(this),\n      hasFocus: function hasFocus() {\n        return true;\n      },\n      tabIndex: null\n    };\n  },\n  _renderCaption: function _renderCaption() {\n    var _this2 = this;\n\n    var date = this.option(\"displayedDate\") || this.option(\"date\");\n\n    var captionConfig = this._getConfig().getCaption.call(this, date);\n\n    var customizationFunction = this.option(\"customizeDateNavigatorText\");\n    var caption = isFunction(customizationFunction) ? customizationFunction(captionConfig) : captionConfig.text;\n\n    this._caption.option({\n      text: caption,\n      onKeyboardHandled: function onKeyboardHandled(opts) {\n        _this2.option(\"focusStateEnabled\") && !_this2.option(\"disabled\") && _this2._calendar._keyboardHandler(opts);\n      },\n      onClick: function onClick() {\n        return _this2._popover.toggle();\n      }\n    });\n  },\n  _renderCaptionKeys: function _renderCaptionKeys() {\n    if (!this.option(\"focusStateEnabled\") || this.option(\"disabled\")) {\n      return;\n    }\n\n    var that = this;\n\n    var executeHandler = function executeHandler() {\n      if (that._popover.$content().is(\":hidden\")) {\n        that._popover.show();\n      } else {\n        return true;\n      }\n    };\n\n    this._caption.registerKeyHandler(\"enter\", executeHandler);\n\n    this._caption.registerKeyHandler(\"space\", executeHandler);\n\n    this._caption.registerKeyHandler(\"tab\", function () {\n      that._popover.hide();\n    });\n  },\n  _setCalendarOption: function _setCalendarOption(name, value) {\n    if (this._calendar) {\n      this._calendar.option(name, value);\n    }\n  },\n  _getConfig: function _getConfig() {\n    var step = this.option(\"step\");\n    var config = getConfig.call(this, step);\n\n    if (!config) {\n      throw errors.Error(\"E1033\", step);\n    }\n\n    return config;\n  }\n}).include(publisherMixin);\nregisterComponent(\"dxSchedulerNavigator\", Navigator);","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/ui/scheduler/header/navigator.js"],"names":["$","noop","isNumeric","isDefined","isFunction","errors","dateUtils","extend","registerComponent","devices","Widget","Button","Calendar","Popover","Popup","publisherMixin","dateLocalization","Scrollable","ELEMENT_CLASS","CALENDAR_CLASS","NEXT_BUTTON_CLASS","CAPTION_BUTTON_CLASS","PREVIOUS_BUTTON_CLASS","CALENDAR_POPOVER_CLASS","MONDAY_INDEX","getDefaultFirstDayOfWeekIndex","shift","firstDayOfWeekIndex","getDateMonthFormat","short","date","monthName","getMonthNames","getMonth","format","join","getMonthYearFormat","getCaptionFormat","intervalCount","duration","dateMonthFormat","lastIntervalDate","Date","defaultViewDuration","setDate","getDate","isDifferentMonthDates","useShortFormat","firstWeekDateText","lastWeekDateText","getWeekCaption","rejectWeekend","firstDayOfWeek","option","firstWeekDate","getFirstWeekDate","normalizeDateByWeek","lastWeekDate","getDay","text","formatCaptionByMonths","call","startDate","endDate","lastDate","firstDate","isDifferentYears","getFullYear","lastDateText","firstDateText","getMonthCaption","getFirstMonthDate","getLastMonthDate","setMonth","isSameYear","getYear","dateGetter","offset","setter","getter","getConfig","step","agendaDuration","getCaption","_getConfig","currentDate","getLastMonthDay","invoke","Navigator","inherit","_getDefaultOptions","callBase","displayedDate","min","max","_useShortDateFormat","todayDate","_defaultOptionsRules","concat","device","real","generic","isSimulator","options","_optionChanged","args","name","_updateButtonsState","_renderCaption","_setCalendarOption","value","_next","_caption","_prev","_init","$element","addClass","_initButtons","$next","_createComponent","icon","onClick","_updateCurrentDate","bind","focusStateEnabled","tabIndex","integrationOptions","$caption","$prev","setAria","append","caption","trimTime","setHours","isNaN","getTime","_getNextDate","direction","normalizeDate","notifyObserver","initialDate","arguments","length","stepConfig","_renderFocusTarget","_initMarkup","_render","_renderPopover","_renderCaptionKeys","_isMobileLayout","current","overlayType","popoverContainer","_popover","contentTemplate","_createPopupContent","defaultOptionsRules","fullScreen","showCloseButton","toolbarItems","shortcut","target","appendTo","_createScrollable","content","result","$content","_calendar","_calendarOptions","scrollable","_todayDate","onValueChanged","e","hide","hasFocus","captionConfig","customizationFunction","onKeyboardHandled","opts","_keyboardHandler","toggle","that","executeHandler","is","show","registerKeyHandler","config","Error","include"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/scheduler/header/navigator.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../../core/renderer\";\r\nimport {\r\n    noop\r\n} from \"../../../core/utils/common\";\r\nimport {\r\n    isNumeric,\r\n    isDefined,\r\n    isFunction\r\n} from \"../../../core/utils/type\";\r\nimport errors from \"../../widget/ui.errors\";\r\nimport dateUtils from \"../../../core/utils/date\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport registerComponent from \"../../../core/component_registrator\";\r\nimport devices from \"../../../core/devices\";\r\nimport Widget from \"../../widget/ui.widget\";\r\nimport Button from \"../../button\";\r\nimport Calendar from \"../../calendar\";\r\nimport Popover from \"../../popover\";\r\nimport Popup from \"../../popup\";\r\nimport publisherMixin from \"../publisher_mixin\";\r\nimport dateLocalization from \"../../../localization/date\";\r\nimport Scrollable from \"../../scroll_view/ui.scrollable\";\r\nvar ELEMENT_CLASS = \"dx-scheduler-navigator\";\r\nvar CALENDAR_CLASS = \"dx-scheduler-navigator-calendar\";\r\nvar NEXT_BUTTON_CLASS = \"dx-scheduler-navigator-next\";\r\nvar CAPTION_BUTTON_CLASS = \"dx-scheduler-navigator-caption\";\r\nvar PREVIOUS_BUTTON_CLASS = \"dx-scheduler-navigator-previous\";\r\nvar CALENDAR_POPOVER_CLASS = \"dx-scheduler-navigator-calendar-popover\";\r\nvar MONDAY_INDEX = 1;\r\nvar getDefaultFirstDayOfWeekIndex = function(shift) {\r\n    return shift ? MONDAY_INDEX : dateLocalization.firstDayOfWeekIndex()\r\n};\r\nvar getDateMonthFormat = function(short) {\r\n    return function(date) {\r\n        var monthName = dateLocalization.getMonthNames(short ? \"abbreviated\" : \"wide\")[date.getMonth()];\r\n        return [dateLocalization.format(date, \"day\"), monthName].join(\" \")\r\n    }\r\n};\r\nvar getMonthYearFormat = function(date) {\r\n    return dateLocalization.getMonthNames(\"abbreviated\")[date.getMonth()] + \" \" + dateLocalization.format(date, \"year\")\r\n};\r\nvar getCaptionFormat = function getCaptionFormat(short, intervalCount, duration) {\r\n    var dateMonthFormat = getDateMonthFormat(short);\r\n    return function(date) {\r\n        if (intervalCount > 1) {\r\n            var lastIntervalDate = new Date(date);\r\n            var defaultViewDuration = duration;\r\n            lastIntervalDate.setDate(date.getDate() + defaultViewDuration - 1);\r\n            var isDifferentMonthDates = date.getMonth() !== lastIntervalDate.getMonth();\r\n            var useShortFormat = isDifferentMonthDates || short;\r\n            var firstWeekDateText = dateLocalization.format(date, isDifferentMonthDates ? getDateMonthFormat(useShortFormat) : \"d\");\r\n            var lastWeekDateText = dateLocalization.format(lastIntervalDate, getCaptionFormat(useShortFormat));\r\n            return firstWeekDateText + \"-\" + lastWeekDateText\r\n        }\r\n        return [dateMonthFormat(date), dateLocalization.format(date, \"year\")].join(\" \")\r\n    }\r\n};\r\nvar getWeekCaption = function(date, shift, rejectWeekend) {\r\n    var firstDayOfWeek = this.option(\"firstDayOfWeek\");\r\n    var firstDayOfWeekIndex = isDefined(firstDayOfWeek) ? firstDayOfWeek : getDefaultFirstDayOfWeekIndex(shift);\r\n    if (0 === firstDayOfWeekIndex && rejectWeekend) {\r\n        firstDayOfWeekIndex = MONDAY_INDEX\r\n    }\r\n    var firstWeekDate = dateUtils.getFirstWeekDate(date, firstDayOfWeekIndex);\r\n    if (rejectWeekend) {\r\n        firstWeekDate = dateUtils.normalizeDateByWeek(firstWeekDate, date)\r\n    }\r\n    if (firstDayOfWeek >= 6 && rejectWeekend) {\r\n        firstWeekDate.setDate(firstWeekDate.getDate() + (7 - firstDayOfWeek + 1))\r\n    }\r\n    var lastWeekDate = new Date(firstWeekDate);\r\n    var intervalCount = this.option(\"intervalCount\");\r\n    shift = shift || 6;\r\n    lastWeekDate = new Date(lastWeekDate.setDate(lastWeekDate.getDate() + (intervalCount > 1 ? 7 * (intervalCount - 1) + shift : shift)));\r\n    if (lastWeekDate.getDay() % 6 === 0 && rejectWeekend) {\r\n        lastWeekDate.setDate(lastWeekDate.getDate() + 2)\r\n    }\r\n    return {\r\n        text: formatCaptionByMonths.call(this, lastWeekDate, firstWeekDate),\r\n        startDate: firstWeekDate,\r\n        endDate: lastWeekDate\r\n    }\r\n};\r\nvar formatCaptionByMonths = function(lastDate, firstDate) {\r\n    var isDifferentMonthDates = firstDate.getMonth() !== lastDate.getMonth();\r\n    var isDifferentYears = firstDate.getFullYear() !== lastDate.getFullYear();\r\n    var useShortFormat = isDifferentMonthDates || this.option(\"_useShortDateFormat\");\r\n    var lastDateText;\r\n    var firstDateText;\r\n    if (isDifferentYears) {\r\n        firstDateText = dateLocalization.format(firstDate, getCaptionFormat(true));\r\n        lastDateText = dateLocalization.format(lastDate, getCaptionFormat(true))\r\n    } else {\r\n        firstDateText = dateLocalization.format(firstDate, isDifferentMonthDates ? getDateMonthFormat(useShortFormat) : \"d\");\r\n        lastDateText = dateLocalization.format(lastDate, getCaptionFormat(useShortFormat))\r\n    }\r\n    return firstDateText + \"-\" + lastDateText\r\n};\r\nvar getMonthCaption = function(date) {\r\n    var firstDate = new Date(dateUtils.getFirstMonthDate(date));\r\n    var lastDate = new Date(dateUtils.getLastMonthDate(firstDate));\r\n    var text;\r\n    if (this.option(\"intervalCount\") > 1) {\r\n        lastDate = new Date(firstDate);\r\n        lastDate.setMonth(firstDate.getMonth() + this.option(\"intervalCount\") - 1);\r\n        lastDate = new Date(dateUtils.getLastMonthDate(lastDate));\r\n        var isSameYear = firstDate.getYear() === lastDate.getYear();\r\n        var lastDateText = getMonthYearFormat(lastDate);\r\n        var firstDateText = isSameYear ? dateLocalization.getMonthNames(\"abbreviated\")[firstDate.getMonth()] : getMonthYearFormat(firstDate);\r\n        text = firstDateText + \"-\" + lastDateText\r\n    } else {\r\n        text = dateLocalization.format(date, \"monthandyear\")\r\n    }\r\n    return {\r\n        text: text,\r\n        startDate: firstDate,\r\n        endDate: lastDate\r\n    }\r\n};\r\nvar dateGetter = function(date, offset) {\r\n    return new Date(date[this.setter](date[this.getter]() + offset))\r\n};\r\nvar getConfig = function(step) {\r\n    var agendaDuration;\r\n    switch (step) {\r\n        case \"day\":\r\n            return {\r\n                duration: 1 * this.option(\"intervalCount\"), setter: \"setDate\", getter: \"getDate\", getDate: dateGetter, getCaption: function(date) {\r\n                    var format = getCaptionFormat(false, this.option(\"intervalCount\"), this._getConfig().duration);\r\n                    return {\r\n                        text: dateLocalization.format(date, format),\r\n                        startDate: date,\r\n                        endDate: date\r\n                    }\r\n                }\r\n            };\r\n        case \"week\":\r\n            return {\r\n                duration: 7 * this.option(\"intervalCount\"), setter: \"setDate\", getter: \"getDate\", getDate: dateGetter, getCaption: getWeekCaption\r\n            };\r\n        case \"workWeek\":\r\n            return {\r\n                duration: 7 * this.option(\"intervalCount\"), setter: \"setDate\", getter: \"getDate\", getDate: dateGetter, getCaption: function(date) {\r\n                    return getWeekCaption.call(this, date, 4, true)\r\n                }\r\n            };\r\n        case \"month\":\r\n            return {\r\n                duration: 1 * this.option(\"intervalCount\"), setter: \"setMonth\", getter: \"getMonth\", getDate: function(date, offset) {\r\n                    var currentDate = date.getDate();\r\n                    date.setDate(1);\r\n                    date = dateGetter.call(this, date, offset);\r\n                    var lastDate = dateUtils.getLastMonthDay(date);\r\n                    date.setDate(currentDate < lastDate ? currentDate : lastDate);\r\n                    return date\r\n                }, getCaption: getMonthCaption\r\n            };\r\n        case \"agenda\":\r\n            agendaDuration = this.invoke(\"getAgendaDuration\");\r\n            agendaDuration = isNumeric(agendaDuration) && agendaDuration > 0 ? agendaDuration : 7;\r\n            return {\r\n                duration: agendaDuration, setter: \"setDate\", getter: \"getDate\", getDate: dateGetter, getCaption: function(date) {\r\n                    var format = getCaptionFormat(this.option(\"_useShortDateFormat\"));\r\n                    var firstDate = new Date(date);\r\n                    var lastDate = new Date(date);\r\n                    var text;\r\n                    if (agendaDuration > 1) {\r\n                        lastDate.setDate(lastDate.getDate() + agendaDuration - 1);\r\n                        text = formatCaptionByMonths.call(this, lastDate, date)\r\n                    } else {\r\n                        text = dateLocalization.format(date, format)\r\n                    }\r\n                    return {\r\n                        text: text,\r\n                        startDate: firstDate,\r\n                        endDate: lastDate\r\n                    }\r\n                }\r\n            }\r\n    }\r\n};\r\nexport var Navigator = Widget.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            date: new Date,\r\n            displayedDate: void 0,\r\n            step: \"day\",\r\n            intervalCount: 1,\r\n            min: void 0,\r\n            max: void 0,\r\n            firstDayOfWeek: void 0,\r\n            _useShortDateFormat: false,\r\n            todayDate: () => new Date\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: function() {\r\n                return !devices.real().generic || devices.isSimulator()\r\n            },\r\n            options: {\r\n                _useShortDateFormat: true\r\n            }\r\n        }])\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"step\":\r\n            case \"date\":\r\n            case \"intervalCount\":\r\n            case \"displayedDate\":\r\n                this._updateButtonsState();\r\n                this._renderCaption();\r\n                this._setCalendarOption(\"value\", this.option(\"date\"));\r\n                break;\r\n            case \"min\":\r\n            case \"max\":\r\n                this._updateButtonsState();\r\n                this._setCalendarOption(args.name, args.value);\r\n                break;\r\n            case \"firstDayOfWeek\":\r\n                this._setCalendarOption(args.name, args.value);\r\n                break;\r\n            case \"customizeDateNavigatorText\":\r\n                this._renderCaption();\r\n                break;\r\n            case \"tabIndex\":\r\n            case \"focusStateEnabled\":\r\n                this._next.option(args.name, args.value);\r\n                this._caption.option(args.name, args.value);\r\n                this._prev.option(args.name, args.value);\r\n                this._setCalendarOption(args.name, args.value);\r\n                this.callBase(args);\r\n                break;\r\n            case \"_useShortDateFormat\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this.$element().addClass(ELEMENT_CLASS);\r\n        this._initButtons()\r\n    },\r\n    _initButtons: function() {\r\n        var $next = $(\"<div>\").addClass(NEXT_BUTTON_CLASS);\r\n        this._next = this._createComponent($next, Button, {\r\n            icon: \"chevronnext\",\r\n            onClick: this._updateCurrentDate.bind(this, 1),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            tabIndex: this.option(\"tabIndex\"),\r\n            integrationOptions: {}\r\n        });\r\n        var $caption = $(\"<div>\").addClass(CAPTION_BUTTON_CLASS);\r\n        this._caption = this._createComponent($caption, Button, {\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            tabIndex: this.option(\"tabIndex\"),\r\n            integrationOptions: {}\r\n        });\r\n        var $prev = $(\"<div>\").addClass(PREVIOUS_BUTTON_CLASS);\r\n        this._prev = this._createComponent($prev, Button, {\r\n            icon: \"chevronprev\",\r\n            onClick: this._updateCurrentDate.bind(this, -1),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            tabIndex: this.option(\"tabIndex\"),\r\n            integrationOptions: {}\r\n        });\r\n        this.setAria(\"label\", \"Next period\", $next);\r\n        this.setAria(\"label\", \"Previous period\", $prev);\r\n        this._updateButtonsState();\r\n        this.$element().append($prev, $caption, $next)\r\n    },\r\n    _updateButtonsState: function() {\r\n        var min = this.option(\"min\");\r\n        var max = this.option(\"max\");\r\n        var caption = this._getConfig().getCaption.call(this, this.option(\"displayedDate\") || this.option(\"date\"));\r\n        min = min ? dateUtils.trimTime(min) : min;\r\n        max = max ? dateUtils.trimTime(max) : max;\r\n        max && max.setHours(23, 59, 59);\r\n        this._prev.option(\"disabled\", min && !isNaN(min.getTime()) && this._getNextDate(-1, caption.endDate) < min);\r\n        this._next.option(\"disabled\", max && !isNaN(max.getTime()) && this._getNextDate(1, caption.startDate) > max)\r\n    },\r\n    _updateCurrentDate: function(direction) {\r\n        var date = this._getNextDate(direction);\r\n        dateUtils.normalizeDate(date, this.option(\"min\"), this.option(\"max\"));\r\n        this.notifyObserver(\"currentDateUpdated\", date)\r\n    },\r\n    _getNextDate: function(direction) {\r\n        var initialDate = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null;\r\n        var stepConfig = this._getConfig();\r\n        var offset = stepConfig.duration * direction;\r\n        var date = stepConfig.getDate(new Date(initialDate || this.option(\"date\")), offset);\r\n        return date\r\n    },\r\n    _renderFocusTarget: noop,\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        this._renderCaption()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._renderPopover();\r\n        this._renderCaptionKeys()\r\n    },\r\n    _isMobileLayout: function() {\r\n        return !devices.current().generic\r\n    },\r\n    _renderPopover: function() {\r\n        var overlayType = this._isMobileLayout() ? Popup : Popover;\r\n        var popoverContainer = $(\"<div>\").addClass(CALENDAR_POPOVER_CLASS);\r\n        this._popover = this._createComponent(popoverContainer, overlayType, {\r\n            contentTemplate: () => this._createPopupContent(),\r\n            defaultOptionsRules: [{\r\n                device: function() {\r\n                    return !devices.current().generic\r\n                },\r\n                options: {\r\n                    fullScreen: true,\r\n                    showCloseButton: false,\r\n                    toolbarItems: [{\r\n                        shortcut: \"cancel\"\r\n                    }]\r\n                }\r\n            }, {\r\n                device: function() {\r\n                    return devices.current().generic\r\n                },\r\n                options: {\r\n                    target: this._caption.$element()\r\n                }\r\n            }]\r\n        });\r\n        this._popover.$element().appendTo(this.$element())\r\n    },\r\n    _createScrollable: function(content) {\r\n        var result = this._createComponent($(\"<div>\"), Scrollable, {\r\n            direction: \"vertical\"\r\n        });\r\n        result.$content().append(content);\r\n        return result\r\n    },\r\n    _createPopupContent: function() {\r\n        var result = $(\"<div>\").addClass(CALENDAR_CLASS);\r\n        this._calendar = this._createComponent(result, Calendar, this._calendarOptions());\r\n        if (this._isMobileLayout()) {\r\n            var scrollable = this._createScrollable(result);\r\n            return scrollable.$element()\r\n        }\r\n        return result\r\n    },\r\n    _calendarOptions: function() {\r\n        return {\r\n            min: this.option(\"min\"),\r\n            max: this.option(\"max\"),\r\n            firstDayOfWeek: this.option(\"firstDayOfWeek\"),\r\n            value: this.option(\"date\"),\r\n            _todayDate: this.option(\"todayDate\"),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            onValueChanged: function(e) {\r\n                if (!this.option(\"visible\")) {\r\n                    return\r\n                }\r\n                this.notifyObserver(\"currentDateUpdated\", e.value);\r\n                this._popover.hide()\r\n            }.bind(this),\r\n            hasFocus: function() {\r\n                return true\r\n            },\r\n            tabIndex: null\r\n        }\r\n    },\r\n    _renderCaption: function() {\r\n        var date = this.option(\"displayedDate\") || this.option(\"date\");\r\n        var captionConfig = this._getConfig().getCaption.call(this, date);\r\n        var customizationFunction = this.option(\"customizeDateNavigatorText\");\r\n        var caption = isFunction(customizationFunction) ? customizationFunction(captionConfig) : captionConfig.text;\r\n        this._caption.option({\r\n            text: caption,\r\n            onKeyboardHandled: opts => {\r\n                this.option(\"focusStateEnabled\") && !this.option(\"disabled\") && this._calendar._keyboardHandler(opts)\r\n            },\r\n            onClick: () => this._popover.toggle()\r\n        })\r\n    },\r\n    _renderCaptionKeys: function() {\r\n        if (!this.option(\"focusStateEnabled\") || this.option(\"disabled\")) {\r\n            return\r\n        }\r\n        var that = this;\r\n        var executeHandler = function() {\r\n            if (that._popover.$content().is(\":hidden\")) {\r\n                that._popover.show()\r\n            } else {\r\n                return true\r\n            }\r\n        };\r\n        this._caption.registerKeyHandler(\"enter\", executeHandler);\r\n        this._caption.registerKeyHandler(\"space\", executeHandler);\r\n        this._caption.registerKeyHandler(\"tab\", (function() {\r\n            that._popover.hide()\r\n        }))\r\n    },\r\n    _setCalendarOption: function(name, value) {\r\n        if (this._calendar) {\r\n            this._calendar.option(name, value)\r\n        }\r\n    },\r\n    _getConfig: function() {\r\n        var step = this.option(\"step\");\r\n        var config = getConfig.call(this, step);\r\n        if (!config) {\r\n            throw errors.Error(\"E1033\", step)\r\n        }\r\n        return config\r\n    }\r\n}).include(publisherMixin);\r\nregisterComponent(\"dxSchedulerNavigator\", Navigator);\r\n"]},"metadata":{},"sourceType":"module"}