{"ast":null,"code":"import _classCallCheck from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\n/**\r\n * DevExtreme (esm/ui/file_manager/ui.file_manager.context_menu.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport { extend } from \"../../core/utils/extend\";\nimport { isDefined, isString } from \"../../core/utils/type\";\nimport { ensureDefined } from \"../../core/utils/common\";\nimport Widget from \"../widget/ui.widget\";\nimport ContextMenu from \"../context_menu/ui.context_menu\";\nimport { extendAttributes } from \"./ui.file_manager.common\";\nvar FILEMANAGER_CONTEXT_MEMU_CLASS = \"dx-filemanager-context-menu\";\nvar DEFAULT_CONTEXT_MENU_ITEMS = {\n  create: {},\n  upload: {},\n  download: {},\n  rename: {},\n  move: {},\n  copy: {},\n  delete: {},\n  refresh: {\n    beginGroup: true\n  }\n};\nvar DEFAULT_ITEM_ALLOWED_PROPERTIES = [\"beginGroup\", \"closeMenuOnClick\", \"disabled\", \"icon\", \"selectable\", \"selected\", \"text\", \"visible\"];\n\nvar FileManagerContextMenu = /*#__PURE__*/function (_Widget) {\n  _inherits(FileManagerContextMenu, _Widget);\n\n  var _super = _createSuper(FileManagerContextMenu);\n\n  function FileManagerContextMenu() {\n    _classCallCheck(this, FileManagerContextMenu);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FileManagerContextMenu, [{\n    key: \"_initMarkup\",\n    value: function _initMarkup() {\n      var _this = this;\n\n      this._initActions();\n\n      this._isVisible = false;\n      var $menu = $(\"<div>\").appendTo(this.$element());\n      this._contextMenu = this._createComponent($menu, ContextMenu, {\n        cssClass: FILEMANAGER_CONTEXT_MEMU_CLASS,\n        showEvent: \"\",\n        onItemClick: function onItemClick(args) {\n          return _this._onContextMenuItemClick(args.itemData.name, args);\n        },\n        onShowing: function onShowing(e) {\n          return _this._onContextMenuShowing(e);\n        },\n        onShown: function onShown() {\n          return _this._onContextMenuShown();\n        },\n        onHidden: function onHidden() {\n          return _this._onContextMenuHidden();\n        }\n      });\n\n      _get(_getPrototypeOf(FileManagerContextMenu.prototype), \"_initMarkup\", this).call(this);\n    }\n  }, {\n    key: \"showAt\",\n    value: function showAt(fileItems, element, event, target) {\n      var itemData = target.itemData,\n          itemElement = target.itemElement,\n          _target$isActionButto = target.isActionButton,\n          isActionButton = _target$isActionButto === void 0 ? false : _target$isActionButto;\n\n      if (this._isVisible) {\n        this._onContextMenuHidden();\n      }\n\n      this._menuShowingContext = {\n        targetElement: itemElement,\n        itemData: itemData,\n        fileItems: fileItems,\n        event: event,\n        isActionButton: isActionButton\n      };\n      var position = {\n        of: element,\n        at: \"top left\",\n        my: \"top left\",\n        offset: \"\"\n      };\n\n      if (event) {\n        position.offset = event.offsetX + \" \" + event.offsetY;\n      } else {\n        position.my = \"left top\";\n        position.at = \"left bottom\";\n        position.boundaryOffset = \"1\";\n      }\n\n      this._contextMenu.option({\n        target: element,\n        position: position\n      });\n\n      this._contextMenu.show();\n    }\n  }, {\n    key: \"createContextMenuItems\",\n    value: function createContextMenuItems(fileItems, contextMenuItems, targetFileItem) {\n      var _this2 = this;\n\n      this._targetFileItems = fileItems;\n      this._targetFileItem = isDefined(targetFileItem) ? targetFileItem : null === fileItems || void 0 === fileItems ? void 0 : fileItems[0];\n      var result = [];\n      var itemArray = contextMenuItems || this.option(\"items\");\n      itemArray.forEach(function (srcItem) {\n        var commandName = isString(srcItem) ? srcItem : srcItem.name;\n\n        var item = _this2._configureItemByCommandName(commandName, srcItem, fileItems, _this2._targetFileItem);\n\n        if (_this2._isContextMenuItemAvailable(item, fileItems)) {\n          result.push(item);\n        }\n      });\n      return result;\n    }\n  }, {\n    key: \"_isContextMenuItemAvailable\",\n    value: function _isContextMenuItemAvailable(menuItem, fileItems) {\n      if (!this._isDefaultItem(menuItem.name) || !menuItem._autoHide) {\n        return ensureDefined(menuItem.visible, true);\n      }\n\n      if (this._isIsolatedCreationItemCommand(menuItem.name) && fileItems && fileItems.length) {\n        return false;\n      }\n\n      return this._commandManager.isCommandAvailable(menuItem.name, fileItems);\n    }\n  }, {\n    key: \"_isIsolatedCreationItemCommand\",\n    value: function _isIsolatedCreationItemCommand(commandName) {\n      return (\"create\" === commandName || \"upload\" === commandName) && this.option(\"isolateCreationItemCommands\");\n    }\n  }, {\n    key: \"_isDefaultItem\",\n    value: function _isDefaultItem(commandName) {\n      return !!DEFAULT_CONTEXT_MENU_ITEMS[commandName];\n    }\n  }, {\n    key: \"_configureItemByCommandName\",\n    value: function _configureItemByCommandName(commandName, item, fileItems, targetFileItem) {\n      if (!this._isDefaultItem(commandName)) {\n        var res = extend(true, {}, item);\n        res.originalItemData = item;\n\n        this._addItemClickHandler(commandName, res);\n\n        if (Array.isArray(item.items)) {\n          res.items = this.createContextMenuItems(fileItems, item.items, targetFileItem);\n        }\n\n        return res;\n      }\n\n      var result = this._createMenuItemByCommandName(commandName);\n\n      var defaultConfig = DEFAULT_CONTEXT_MENU_ITEMS[commandName];\n      extend(result, defaultConfig);\n      result.originalItemData = item;\n      extendAttributes(result, item, DEFAULT_ITEM_ALLOWED_PROPERTIES);\n\n      if (!isDefined(result.visible)) {\n        result._autoHide = true;\n      }\n\n      if (commandName && !result.name) {\n        extend(result, {\n          name: commandName\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_createMenuItemByCommandName\",\n    value: function _createMenuItemByCommandName(commandName) {\n      var _this$_commandManager = this._commandManager.getCommandByName(commandName),\n          text = _this$_commandManager.text,\n          icon = _this$_commandManager.icon;\n\n      var menuItem = {\n        name: commandName,\n        text: text,\n        icon: icon\n      };\n\n      this._addItemClickHandler(commandName, menuItem);\n\n      return menuItem;\n    }\n  }, {\n    key: \"_addItemClickHandler\",\n    value: function _addItemClickHandler(commandName, contextMenuItem) {\n      var _this3 = this;\n\n      contextMenuItem.onItemClick = function (args) {\n        return _this3._onContextMenuItemClick(commandName, args);\n      };\n    }\n  }, {\n    key: \"_onContextMenuItemClick\",\n    value: function _onContextMenuItemClick(commandName, args) {\n      var _this$_targetFileItem;\n\n      var changedArgs = extend(true, {}, args);\n      changedArgs.itemData = args.itemData.originalItemData;\n      changedArgs.fileSystemItem = null === (_this$_targetFileItem = this._targetFileItem) || void 0 === _this$_targetFileItem ? void 0 : _this$_targetFileItem.fileItem;\n      changedArgs.viewArea = this.option(\"viewArea\");\n\n      this._actions.onItemClick(changedArgs);\n\n      if (this._isDefaultItem(commandName)) {\n        var targetFileItems = this._isIsolatedCreationItemCommand(commandName) ? null : this._targetFileItems;\n\n        this._commandManager.executeCommand(commandName, targetFileItems);\n      }\n    }\n  }, {\n    key: \"_initActions\",\n    value: function _initActions() {\n      this._actions = {\n        onContextMenuHidden: this._createActionByOption(\"onContextMenuHidden\"),\n        onContextMenuShowing: this._createActionByOption(\"onContextMenuShowing\"),\n        onItemClick: this._createActionByOption(\"onItemClick\")\n      };\n    }\n  }, {\n    key: \"_onContextMenuShowing\",\n    value: function _onContextMenuShowing(e) {\n      if (this._isVisible) {\n        this._onContextMenuHidden();\n      }\n\n      e = extend(e, this._menuShowingContext, {\n        options: this.option(),\n        cancel: false\n      });\n\n      this._actions.onContextMenuShowing(e);\n\n      if (!e.cancel) {\n        var items = this.createContextMenuItems(this._menuShowingContext.fileItems, null, this._menuShowingContext.fileSystemItem);\n\n        this._contextMenu.option(\"dataSource\", items);\n      }\n    }\n  }, {\n    key: \"_onContextMenuShown\",\n    value: function _onContextMenuShown() {\n      this._isVisible = true;\n    }\n  }, {\n    key: \"_onContextMenuHidden\",\n    value: function _onContextMenuHidden() {\n      this._isVisible = false;\n      this._menuShowingContext = {};\n\n      this._contextMenu.option(\"visible\", false);\n\n      this._raiseContextMenuHidden();\n    }\n  }, {\n    key: \"_raiseContextMenuHidden\",\n    value: function _raiseContextMenuHidden() {\n      this._actions.onContextMenuHidden();\n    }\n  }, {\n    key: \"_getDefaultOptions\",\n    value: function _getDefaultOptions() {\n      return extend(_get(_getPrototypeOf(FileManagerContextMenu.prototype), \"_getDefaultOptions\", this).call(this), {\n        commandManager: null,\n        onContextMenuHidden: null,\n        onItemClick: null\n      });\n    }\n  }, {\n    key: \"_optionChanged\",\n    value: function _optionChanged(args) {\n      var name = args.name;\n\n      switch (name) {\n        case \"commandManager\":\n          this.repaint();\n          break;\n\n        case \"items\":\n          if (this._isVisible) {\n            var items = this.createContextMenuItems(this._targetFileItems);\n\n            this._contextMenu.option(\"dataSource\", items);\n          }\n\n          break;\n\n        case \"onItemClick\":\n        case \"onContextMenuShowing\":\n        case \"onContextMenuHidden\":\n          this._actions[name] = this._createActionByOption(name);\n          break;\n\n        default:\n          _get(_getPrototypeOf(FileManagerContextMenu.prototype), \"_optionChanged\", this).call(this, args);\n\n      }\n    }\n  }, {\n    key: \"_commandManager\",\n    get: function get() {\n      return this.option(\"commandManager\");\n    }\n  }]);\n\n  return FileManagerContextMenu;\n}(Widget);\n\nexport default FileManagerContextMenu;","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/ui/file_manager/ui.file_manager.context_menu.js"],"names":["$","extend","isDefined","isString","ensureDefined","Widget","ContextMenu","extendAttributes","FILEMANAGER_CONTEXT_MEMU_CLASS","DEFAULT_CONTEXT_MENU_ITEMS","create","upload","download","rename","move","copy","delete","refresh","beginGroup","DEFAULT_ITEM_ALLOWED_PROPERTIES","FileManagerContextMenu","_initActions","_isVisible","$menu","appendTo","$element","_contextMenu","_createComponent","cssClass","showEvent","onItemClick","args","_onContextMenuItemClick","itemData","name","onShowing","e","_onContextMenuShowing","onShown","_onContextMenuShown","onHidden","_onContextMenuHidden","fileItems","element","event","target","itemElement","isActionButton","_menuShowingContext","targetElement","position","of","at","my","offset","offsetX","offsetY","boundaryOffset","option","show","contextMenuItems","targetFileItem","_targetFileItems","_targetFileItem","result","itemArray","forEach","srcItem","commandName","item","_configureItemByCommandName","_isContextMenuItemAvailable","push","menuItem","_isDefaultItem","_autoHide","visible","_isIsolatedCreationItemCommand","length","_commandManager","isCommandAvailable","res","originalItemData","_addItemClickHandler","Array","isArray","items","createContextMenuItems","_createMenuItemByCommandName","defaultConfig","getCommandByName","text","icon","contextMenuItem","_this$_targetFileItem","changedArgs","fileSystemItem","fileItem","viewArea","_actions","targetFileItems","executeCommand","onContextMenuHidden","_createActionByOption","onContextMenuShowing","options","cancel","_raiseContextMenuHidden","commandManager","repaint"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/file_manager/ui.file_manager.context_menu.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    isDefined,\r\n    isString\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    ensureDefined\r\n} from \"../../core/utils/common\";\r\nimport Widget from \"../widget/ui.widget\";\r\nimport ContextMenu from \"../context_menu/ui.context_menu\";\r\nimport {\r\n    extendAttributes\r\n} from \"./ui.file_manager.common\";\r\nvar FILEMANAGER_CONTEXT_MEMU_CLASS = \"dx-filemanager-context-menu\";\r\nvar DEFAULT_CONTEXT_MENU_ITEMS = {\r\n    create: {},\r\n    upload: {},\r\n    download: {},\r\n    rename: {},\r\n    move: {},\r\n    copy: {},\r\n    delete: {},\r\n    refresh: {\r\n        beginGroup: true\r\n    }\r\n};\r\nvar DEFAULT_ITEM_ALLOWED_PROPERTIES = [\"beginGroup\", \"closeMenuOnClick\", \"disabled\", \"icon\", \"selectable\", \"selected\", \"text\", \"visible\"];\r\nclass FileManagerContextMenu extends Widget {\r\n    _initMarkup() {\r\n        this._initActions();\r\n        this._isVisible = false;\r\n        var $menu = $(\"<div>\").appendTo(this.$element());\r\n        this._contextMenu = this._createComponent($menu, ContextMenu, {\r\n            cssClass: FILEMANAGER_CONTEXT_MEMU_CLASS,\r\n            showEvent: \"\",\r\n            onItemClick: args => this._onContextMenuItemClick(args.itemData.name, args),\r\n            onShowing: e => this._onContextMenuShowing(e),\r\n            onShown: () => this._onContextMenuShown(),\r\n            onHidden: () => this._onContextMenuHidden()\r\n        });\r\n        super._initMarkup()\r\n    }\r\n    showAt(fileItems, element, event, target) {\r\n        var {\r\n            itemData: itemData,\r\n            itemElement: itemElement,\r\n            isActionButton: isActionButton = false\r\n        } = target;\r\n        if (this._isVisible) {\r\n            this._onContextMenuHidden()\r\n        }\r\n        this._menuShowingContext = {\r\n            targetElement: itemElement,\r\n            itemData: itemData,\r\n            fileItems: fileItems,\r\n            event: event,\r\n            isActionButton: isActionButton\r\n        };\r\n        var position = {\r\n            of: element,\r\n            at: \"top left\",\r\n            my: \"top left\",\r\n            offset: \"\"\r\n        };\r\n        if (event) {\r\n            position.offset = event.offsetX + \" \" + event.offsetY\r\n        } else {\r\n            position.my = \"left top\";\r\n            position.at = \"left bottom\";\r\n            position.boundaryOffset = \"1\"\r\n        }\r\n        this._contextMenu.option({\r\n            target: element,\r\n            position: position\r\n        });\r\n        this._contextMenu.show()\r\n    }\r\n    createContextMenuItems(fileItems, contextMenuItems, targetFileItem) {\r\n        this._targetFileItems = fileItems;\r\n        this._targetFileItem = isDefined(targetFileItem) ? targetFileItem : null === fileItems || void 0 === fileItems ? void 0 : fileItems[0];\r\n        var result = [];\r\n        var itemArray = contextMenuItems || this.option(\"items\");\r\n        itemArray.forEach(srcItem => {\r\n            var commandName = isString(srcItem) ? srcItem : srcItem.name;\r\n            var item = this._configureItemByCommandName(commandName, srcItem, fileItems, this._targetFileItem);\r\n            if (this._isContextMenuItemAvailable(item, fileItems)) {\r\n                result.push(item)\r\n            }\r\n        });\r\n        return result\r\n    }\r\n    _isContextMenuItemAvailable(menuItem, fileItems) {\r\n        if (!this._isDefaultItem(menuItem.name) || !menuItem._autoHide) {\r\n            return ensureDefined(menuItem.visible, true)\r\n        }\r\n        if (this._isIsolatedCreationItemCommand(menuItem.name) && fileItems && fileItems.length) {\r\n            return false\r\n        }\r\n        return this._commandManager.isCommandAvailable(menuItem.name, fileItems)\r\n    }\r\n    _isIsolatedCreationItemCommand(commandName) {\r\n        return (\"create\" === commandName || \"upload\" === commandName) && this.option(\"isolateCreationItemCommands\")\r\n    }\r\n    _isDefaultItem(commandName) {\r\n        return !!DEFAULT_CONTEXT_MENU_ITEMS[commandName]\r\n    }\r\n    _configureItemByCommandName(commandName, item, fileItems, targetFileItem) {\r\n        if (!this._isDefaultItem(commandName)) {\r\n            var res = extend(true, {}, item);\r\n            res.originalItemData = item;\r\n            this._addItemClickHandler(commandName, res);\r\n            if (Array.isArray(item.items)) {\r\n                res.items = this.createContextMenuItems(fileItems, item.items, targetFileItem)\r\n            }\r\n            return res\r\n        }\r\n        var result = this._createMenuItemByCommandName(commandName);\r\n        var defaultConfig = DEFAULT_CONTEXT_MENU_ITEMS[commandName];\r\n        extend(result, defaultConfig);\r\n        result.originalItemData = item;\r\n        extendAttributes(result, item, DEFAULT_ITEM_ALLOWED_PROPERTIES);\r\n        if (!isDefined(result.visible)) {\r\n            result._autoHide = true\r\n        }\r\n        if (commandName && !result.name) {\r\n            extend(result, {\r\n                name: commandName\r\n            })\r\n        }\r\n        return result\r\n    }\r\n    _createMenuItemByCommandName(commandName) {\r\n        var {\r\n            text: text,\r\n            icon: icon\r\n        } = this._commandManager.getCommandByName(commandName);\r\n        var menuItem = {\r\n            name: commandName,\r\n            text: text,\r\n            icon: icon\r\n        };\r\n        this._addItemClickHandler(commandName, menuItem);\r\n        return menuItem\r\n    }\r\n    _addItemClickHandler(commandName, contextMenuItem) {\r\n        contextMenuItem.onItemClick = args => this._onContextMenuItemClick(commandName, args)\r\n    }\r\n    _onContextMenuItemClick(commandName, args) {\r\n        var _this$_targetFileItem;\r\n        var changedArgs = extend(true, {}, args);\r\n        changedArgs.itemData = args.itemData.originalItemData;\r\n        changedArgs.fileSystemItem = null === (_this$_targetFileItem = this._targetFileItem) || void 0 === _this$_targetFileItem ? void 0 : _this$_targetFileItem.fileItem;\r\n        changedArgs.viewArea = this.option(\"viewArea\");\r\n        this._actions.onItemClick(changedArgs);\r\n        if (this._isDefaultItem(commandName)) {\r\n            var targetFileItems = this._isIsolatedCreationItemCommand(commandName) ? null : this._targetFileItems;\r\n            this._commandManager.executeCommand(commandName, targetFileItems)\r\n        }\r\n    }\r\n    _initActions() {\r\n        this._actions = {\r\n            onContextMenuHidden: this._createActionByOption(\"onContextMenuHidden\"),\r\n            onContextMenuShowing: this._createActionByOption(\"onContextMenuShowing\"),\r\n            onItemClick: this._createActionByOption(\"onItemClick\")\r\n        }\r\n    }\r\n    _onContextMenuShowing(e) {\r\n        if (this._isVisible) {\r\n            this._onContextMenuHidden()\r\n        }\r\n        e = extend(e, this._menuShowingContext, {\r\n            options: this.option(),\r\n            cancel: false\r\n        });\r\n        this._actions.onContextMenuShowing(e);\r\n        if (!e.cancel) {\r\n            var items = this.createContextMenuItems(this._menuShowingContext.fileItems, null, this._menuShowingContext.fileSystemItem);\r\n            this._contextMenu.option(\"dataSource\", items)\r\n        }\r\n    }\r\n    _onContextMenuShown() {\r\n        this._isVisible = true\r\n    }\r\n    _onContextMenuHidden() {\r\n        this._isVisible = false;\r\n        this._menuShowingContext = {};\r\n        this._contextMenu.option(\"visible\", false);\r\n        this._raiseContextMenuHidden()\r\n    }\r\n    _raiseContextMenuHidden() {\r\n        this._actions.onContextMenuHidden()\r\n    }\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            commandManager: null,\r\n            onContextMenuHidden: null,\r\n            onItemClick: null\r\n        })\r\n    }\r\n    _optionChanged(args) {\r\n        var name = args.name;\r\n        switch (name) {\r\n            case \"commandManager\":\r\n                this.repaint();\r\n                break;\r\n            case \"items\":\r\n                if (this._isVisible) {\r\n                    var items = this.createContextMenuItems(this._targetFileItems);\r\n                    this._contextMenu.option(\"dataSource\", items)\r\n                }\r\n                break;\r\n            case \"onItemClick\":\r\n            case \"onContextMenuShowing\":\r\n            case \"onContextMenuHidden\":\r\n                this._actions[name] = this._createActionByOption(name);\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n    get _commandManager() {\r\n        return this.option(\"commandManager\")\r\n    }\r\n}\r\nexport default FileManagerContextMenu;\r\n"]},"metadata":{},"sourceType":"module"}