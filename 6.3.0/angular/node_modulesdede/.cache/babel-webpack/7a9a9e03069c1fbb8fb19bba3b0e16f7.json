{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/map.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../core/renderer\";\nimport eventsEngine from \"../events/core/events_engine\";\nimport Promise from \"../core/polyfills/promise\";\nimport { fromPromise } from \"../core/utils/deferred\";\nimport registerComponent from \"../core/component_registrator\";\nimport errors from \"./widget/ui.errors\";\nimport devices from \"../core/devices\";\nimport Widget from \"./widget/ui.widget\";\nimport { titleize } from \"../core/utils/inflector\";\nimport { each } from \"../core/utils/iterator\";\nimport { extend } from \"../core/utils/extend\";\nimport { inArray, wrapToArray } from \"../core/utils/array\";\nimport { isNumeric } from \"../core/utils/type\";\nimport { addNamespace } from \"../events/utils/index\";\nimport pointerEvents from \"../events/pointer\";\nimport googleStatic from \"./map/provider.google_static\";\nimport google from \"./map/provider.dynamic.google\";\nimport bing from \"./map/provider.dynamic.bing\";\nvar PROVIDERS = {\n  googleStatic: googleStatic,\n  google: google,\n  bing: bing\n};\nvar MAP_CLASS = \"dx-map\";\nvar MAP_CONTAINER_CLASS = \"dx-map-container\";\nvar MAP_SHIELD_CLASS = \"dx-map-shield\";\nvar NATIVE_CLICK_CLASS = \"dx-native-click\";\nvar Map = Widget.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      bounds: {\n        northEast: null,\n        southWest: null\n      },\n      center: {\n        lat: 0,\n        lng: 0\n      },\n      zoom: 1,\n      width: 300,\n      height: 300,\n      type: \"roadmap\",\n      provider: \"google\",\n      autoAdjust: true,\n      markers: [],\n      markerIconSrc: null,\n      onMarkerAdded: null,\n      onMarkerRemoved: null,\n      routes: [],\n      onRouteAdded: null,\n      onRouteRemoved: null,\n      key: {\n        bing: \"\",\n        google: \"\",\n        googleStatic: \"\"\n      },\n      apiKey: {\n        bing: \"\",\n        google: \"\",\n        googleStatic: \"\"\n      },\n      controls: false,\n      onReady: null,\n      onUpdated: null,\n      onClick: null\n    });\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    return this.callBase().concat([{\n      device: function device() {\n        return \"desktop\" === devices.real().deviceType && !devices.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }]);\n  },\n  _setDeprecatedOptions: function _setDeprecatedOptions() {\n    this.callBase();\n    extend(this._deprecatedOptions, {\n      key: {\n        since: \"20.2\",\n        alias: \"apiKey\"\n      }\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n    this.$element().addClass(MAP_CLASS).addClass(NATIVE_CLICK_CLASS);\n    this._lastAsyncAction = Promise.resolve();\n\n    this._checkOption(\"provider\");\n\n    this._checkOption(\"markers\");\n\n    this._checkOption(\"routes\");\n\n    this._initContainer();\n\n    this._grabEvents();\n\n    this._rendered = {};\n  },\n  _useTemplates: function _useTemplates() {\n    return false;\n  },\n  _checkOption: function _checkOption(option) {\n    var value = this.option(option);\n\n    if (\"markers\" === option && !Array.isArray(value)) {\n      throw errors.Error(\"E1022\");\n    }\n\n    if (\"routes\" === option && !Array.isArray(value)) {\n      throw errors.Error(\"E1023\");\n    }\n  },\n  _initContainer: function _initContainer() {\n    this._$container = $(\"<div>\").addClass(MAP_CONTAINER_CLASS);\n    this.$element().append(this._$container);\n  },\n  _grabEvents: function _grabEvents() {\n    var eventName = addNamespace(pointerEvents.down, this.NAME);\n    eventsEngine.on(this.$element(), eventName, this._cancelEvent.bind(this));\n  },\n  _cancelEvent: function _cancelEvent(e) {\n    var cancelByProvider = this._provider && this._provider.isEventsCanceled(e) && !this.option(\"disabled\");\n\n    if (cancelByProvider) {\n      e.stopPropagation();\n    }\n  },\n  _saveRendered: function _saveRendered(option) {\n    var value = this.option(option);\n    this._rendered[option] = value.slice();\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderShield();\n\n    this._saveRendered(\"markers\");\n\n    this._saveRendered(\"routes\");\n\n    this._provider = new PROVIDERS[this.option(\"provider\")](this, this._$container);\n\n    this._queueAsyncAction(\"render\", this._rendered.markers, this._rendered.routes);\n  },\n  _renderShield: function _renderShield() {\n    var $shield;\n\n    if (this.option(\"disabled\")) {\n      $shield = $(\"<div>\").addClass(MAP_SHIELD_CLASS);\n      this.$element().append($shield);\n    } else {\n      $shield = this.$element().find(\".\" + MAP_SHIELD_CLASS);\n      $shield.remove();\n    }\n  },\n  _clean: function _clean() {\n    this._cleanFocusState();\n\n    if (this._provider) {\n      this._provider.clean();\n    }\n\n    this._provider = null;\n    this._lastAsyncAction = Promise.resolve();\n    this.setOptionSilent(\"bounds\", {\n      northEast: null,\n      southWest: null\n    });\n    delete this._suppressAsyncAction;\n  },\n  _optionChanged: function _optionChanged(args) {\n    var name = args.name;\n    var changeBag = this._optionChangeBag;\n    this._optionChangeBag = null;\n\n    switch (name) {\n      case \"disabled\":\n        this._renderShield();\n\n        this.callBase(args);\n        break;\n\n      case \"width\":\n      case \"height\":\n        this.callBase(args);\n\n        this._dimensionChanged();\n\n        break;\n\n      case \"provider\":\n        this._suppressAsyncAction = true;\n\n        this._invalidate();\n\n        break;\n\n      case \"key\":\n      case \"apiKey\":\n        errors.log(\"W1001\");\n        break;\n\n      case \"bounds\":\n        this._queueAsyncAction(\"updateBounds\");\n\n        break;\n\n      case \"center\":\n        this._queueAsyncAction(\"updateCenter\");\n\n        break;\n\n      case \"zoom\":\n        this._queueAsyncAction(\"updateZoom\");\n\n        break;\n\n      case \"type\":\n        this._queueAsyncAction(\"updateMapType\");\n\n        break;\n\n      case \"controls\":\n        this._queueAsyncAction(\"updateControls\", this._rendered.markers, this._rendered.routes);\n\n        break;\n\n      case \"autoAdjust\":\n        this._queueAsyncAction(\"adjustViewport\");\n\n        break;\n\n      case \"markers\":\n      case \"routes\":\n        this._checkOption(name);\n\n        var prevValue = this._rendered[name];\n\n        this._saveRendered(name);\n\n        this._queueAsyncAction(\"update\" + titleize(name), changeBag ? changeBag.removed : prevValue, changeBag ? changeBag.added : this._rendered[name]).then(function (result) {\n          if (changeBag) {\n            changeBag.resolve(result);\n          }\n        });\n\n        break;\n\n      case \"markerIconSrc\":\n        this._queueAsyncAction(\"updateMarkers\", this._rendered.markers, this._rendered.markers);\n\n        break;\n\n      case \"onReady\":\n      case \"onUpdated\":\n      case \"onMarkerAdded\":\n      case \"onMarkerRemoved\":\n      case \"onRouteAdded\":\n      case \"onRouteRemoved\":\n      case \"onClick\":\n        break;\n\n      default:\n        this.callBase.apply(this, arguments);\n    }\n  },\n  _visibilityChanged: function _visibilityChanged(visible) {\n    if (visible) {\n      this._dimensionChanged();\n    }\n  },\n  _dimensionChanged: function _dimensionChanged() {\n    this._queueAsyncAction(\"updateDimensions\");\n  },\n  _queueAsyncAction: function _queueAsyncAction(name) {\n    var options = [].slice.call(arguments).slice(1);\n    var isActionSuppressed = this._suppressAsyncAction;\n    this._lastAsyncAction = this._lastAsyncAction.then(function () {\n      if (!this._provider || isActionSuppressed) {\n        return Promise.resolve();\n      }\n\n      return this._provider[name].apply(this._provider, options).then(function (result) {\n        result = wrapToArray(result);\n        var mapRefreshed = result[0];\n\n        if (mapRefreshed && !this._disposed) {\n          this._triggerReadyAction();\n        }\n\n        return result[1];\n      }.bind(this));\n    }.bind(this));\n    return this._lastAsyncAction;\n  },\n  _triggerReadyAction: function _triggerReadyAction() {\n    this._createActionByOption(\"onReady\")({\n      originalMap: this._provider.map()\n    });\n  },\n  _triggerUpdateAction: function _triggerUpdateAction() {\n    this._createActionByOption(\"onUpdated\")();\n  },\n  setOptionSilent: function setOptionSilent(name, value) {\n    this._setOptionWithoutOptionChange(name, value);\n  },\n  addMarker: function addMarker(marker) {\n    return this._addFunction(\"markers\", marker);\n  },\n  removeMarker: function removeMarker(marker) {\n    return this._removeFunction(\"markers\", marker);\n  },\n  addRoute: function addRoute(route) {\n    return this._addFunction(\"routes\", route);\n  },\n  removeRoute: function removeRoute(route) {\n    return this._removeFunction(\"routes\", route);\n  },\n  _addFunction: function _addFunction(optionName, addingValue) {\n    var optionValue = this.option(optionName);\n    var addingValues = wrapToArray(addingValue);\n    optionValue.push.apply(optionValue, addingValues);\n    return this._partialArrayOptionChange(optionName, optionValue, addingValues, []);\n  },\n  _removeFunction: function _removeFunction(optionName, removingValue) {\n    var optionValue = this.option(optionName);\n    var removingValues = wrapToArray(removingValue);\n    each(removingValues, function (removingIndex, removingValue) {\n      var index = isNumeric(removingValue) ? removingValue : inArray(removingValue, optionValue);\n\n      if (-1 !== index) {\n        var removing = optionValue.splice(index, 1)[0];\n        removingValues.splice(removingIndex, 1, removing);\n      } else {\n        throw errors.log(\"E1021\", titleize(optionName.substring(0, optionName.length - 1)), removingValue);\n      }\n    });\n    return this._partialArrayOptionChange(optionName, optionValue, [], removingValues);\n  },\n  _partialArrayOptionChange: function _partialArrayOptionChange(optionName, optionValue, addingValues, removingValues) {\n    return fromPromise(new Promise(function (resolve) {\n      this._optionChangeBag = {\n        resolve: resolve,\n        added: addingValues,\n        removed: removingValues\n      };\n      this.option(optionName, optionValue);\n    }.bind(this)).then(function (result) {\n      return result && 1 === result.length ? result[0] : result;\n    }), this);\n  }\n});\nregisterComponent(\"dxMap\", Map);\nexport default Map;","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/ui/map.js"],"names":["$","eventsEngine","Promise","fromPromise","registerComponent","errors","devices","Widget","titleize","each","extend","inArray","wrapToArray","isNumeric","addNamespace","pointerEvents","googleStatic","google","bing","PROVIDERS","MAP_CLASS","MAP_CONTAINER_CLASS","MAP_SHIELD_CLASS","NATIVE_CLICK_CLASS","Map","inherit","_getDefaultOptions","callBase","bounds","northEast","southWest","center","lat","lng","zoom","width","height","type","provider","autoAdjust","markers","markerIconSrc","onMarkerAdded","onMarkerRemoved","routes","onRouteAdded","onRouteRemoved","key","apiKey","controls","onReady","onUpdated","onClick","_defaultOptionsRules","concat","device","real","deviceType","isSimulator","options","focusStateEnabled","_setDeprecatedOptions","_deprecatedOptions","since","alias","_init","$element","addClass","_lastAsyncAction","resolve","_checkOption","_initContainer","_grabEvents","_rendered","_useTemplates","option","value","Array","isArray","Error","_$container","append","eventName","down","NAME","on","_cancelEvent","bind","e","cancelByProvider","_provider","isEventsCanceled","stopPropagation","_saveRendered","slice","_render","_renderShield","_queueAsyncAction","$shield","find","remove","_clean","_cleanFocusState","clean","setOptionSilent","_suppressAsyncAction","_optionChanged","args","name","changeBag","_optionChangeBag","_dimensionChanged","_invalidate","log","prevValue","removed","added","then","result","apply","arguments","_visibilityChanged","visible","call","isActionSuppressed","mapRefreshed","_disposed","_triggerReadyAction","_createActionByOption","originalMap","map","_triggerUpdateAction","_setOptionWithoutOptionChange","addMarker","marker","_addFunction","removeMarker","_removeFunction","addRoute","route","removeRoute","optionName","addingValue","optionValue","addingValues","push","_partialArrayOptionChange","removingValue","removingValues","removingIndex","index","removing","splice","substring","length"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAc,kBAAd;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,OAAOC,OAAP,MAAoB,2BAApB;AACA,SACIC,WADJ,QAEO,wBAFP;AAGA,OAAOC,iBAAP,MAA8B,+BAA9B;AACA,OAAOC,MAAP,MAAmB,oBAAnB;AACA,OAAOC,OAAP,MAAoB,iBAApB;AACA,OAAOC,MAAP,MAAmB,oBAAnB;AACA,SACIC,QADJ,QAEO,yBAFP;AAGA,SACIC,IADJ,QAEO,wBAFP;AAGA,SACIC,MADJ,QAEO,sBAFP;AAGA,SACIC,OADJ,EAEIC,WAFJ,QAGO,qBAHP;AAIA,SACIC,SADJ,QAEO,oBAFP;AAGA,SACIC,YADJ,QAEO,uBAFP;AAGA,OAAOC,aAAP,MAA0B,mBAA1B;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,OAAOC,MAAP,MAAmB,+BAAnB;AACA,OAAOC,IAAP,MAAiB,6BAAjB;AACA,IAAIC,SAAS,GAAG;AACZH,EAAAA,YAAY,EAAEA,YADF;AAEZC,EAAAA,MAAM,EAAEA,MAFI;AAGZC,EAAAA,IAAI,EAAEA;AAHM,CAAhB;AAKA,IAAIE,SAAS,GAAG,QAAhB;AACA,IAAIC,mBAAmB,GAAG,kBAA1B;AACA,IAAIC,gBAAgB,GAAG,eAAvB;AACA,IAAIC,kBAAkB,GAAG,iBAAzB;AACA,IAAIC,GAAG,GAAGjB,MAAM,CAACkB,OAAP,CAAe;AACrBC,EAAAA,kBAAkB,EAAE,8BAAW;AAC3B,WAAOhB,MAAM,CAAC,KAAKiB,QAAL,EAAD,EAAkB;AAC3BC,MAAAA,MAAM,EAAE;AACJC,QAAAA,SAAS,EAAE,IADP;AAEJC,QAAAA,SAAS,EAAE;AAFP,OADmB;AAK3BC,MAAAA,MAAM,EAAE;AACJC,QAAAA,GAAG,EAAE,CADD;AAEJC,QAAAA,GAAG,EAAE;AAFD,OALmB;AAS3BC,MAAAA,IAAI,EAAE,CATqB;AAU3BC,MAAAA,KAAK,EAAE,GAVoB;AAW3BC,MAAAA,MAAM,EAAE,GAXmB;AAY3BC,MAAAA,IAAI,EAAE,SAZqB;AAa3BC,MAAAA,QAAQ,EAAE,QAbiB;AAc3BC,MAAAA,UAAU,EAAE,IAde;AAe3BC,MAAAA,OAAO,EAAE,EAfkB;AAgB3BC,MAAAA,aAAa,EAAE,IAhBY;AAiB3BC,MAAAA,aAAa,EAAE,IAjBY;AAkB3BC,MAAAA,eAAe,EAAE,IAlBU;AAmB3BC,MAAAA,MAAM,EAAE,EAnBmB;AAoB3BC,MAAAA,YAAY,EAAE,IApBa;AAqB3BC,MAAAA,cAAc,EAAE,IArBW;AAsB3BC,MAAAA,GAAG,EAAE;AACD7B,QAAAA,IAAI,EAAE,EADL;AAEDD,QAAAA,MAAM,EAAE,EAFP;AAGDD,QAAAA,YAAY,EAAE;AAHb,OAtBsB;AA2B3BgC,MAAAA,MAAM,EAAE;AACJ9B,QAAAA,IAAI,EAAE,EADF;AAEJD,QAAAA,MAAM,EAAE,EAFJ;AAGJD,QAAAA,YAAY,EAAE;AAHV,OA3BmB;AAgC3BiC,MAAAA,QAAQ,EAAE,KAhCiB;AAiC3BC,MAAAA,OAAO,EAAE,IAjCkB;AAkC3BC,MAAAA,SAAS,EAAE,IAlCgB;AAmC3BC,MAAAA,OAAO,EAAE;AAnCkB,KAAlB,CAAb;AAqCH,GAvCoB;AAwCrBC,EAAAA,oBAAoB,EAAE,gCAAW;AAC7B,WAAO,KAAK1B,QAAL,GAAgB2B,MAAhB,CAAuB,CAAC;AAC3BC,MAAAA,MAAM,EAAE,kBAAW;AACf,eAAO,cAAcjD,OAAO,CAACkD,IAAR,GAAeC,UAA7B,IAA2C,CAACnD,OAAO,CAACoD,WAAR,EAAnD;AACH,OAH0B;AAI3BC,MAAAA,OAAO,EAAE;AACLC,QAAAA,iBAAiB,EAAE;AADd;AAJkB,KAAD,CAAvB,CAAP;AAQH,GAjDoB;AAkDrBC,EAAAA,qBAAqB,EAAE,iCAAW;AAC9B,SAAKlC,QAAL;AACAjB,IAAAA,MAAM,CAAC,KAAKoD,kBAAN,EAA0B;AAC5Bf,MAAAA,GAAG,EAAE;AACDgB,QAAAA,KAAK,EAAE,MADN;AAEDC,QAAAA,KAAK,EAAE;AAFN;AADuB,KAA1B,CAAN;AAMH,GA1DoB;AA2DrBC,EAAAA,KAAK,EAAE,iBAAW;AACd,SAAKtC,QAAL;AACA,SAAKuC,QAAL,GAAgBC,QAAhB,CAAyB/C,SAAzB,EAAoC+C,QAApC,CAA6C5C,kBAA7C;AACA,SAAK6C,gBAAL,GAAwBlE,OAAO,CAACmE,OAAR,EAAxB;;AACA,SAAKC,YAAL,CAAkB,UAAlB;;AACA,SAAKA,YAAL,CAAkB,SAAlB;;AACA,SAAKA,YAAL,CAAkB,QAAlB;;AACA,SAAKC,cAAL;;AACA,SAAKC,WAAL;;AACA,SAAKC,SAAL,GAAiB,EAAjB;AACH,GArEoB;AAsErBC,EAAAA,aAAa,EAAE,yBAAW;AACtB,WAAO,KAAP;AACH,GAxEoB;AAyErBJ,EAAAA,YAAY,EAAE,sBAASK,MAAT,EAAiB;AAC3B,QAAIC,KAAK,GAAG,KAAKD,MAAL,CAAYA,MAAZ,CAAZ;;AACA,QAAI,cAAcA,MAAd,IAAwB,CAACE,KAAK,CAACC,OAAN,CAAcF,KAAd,CAA7B,EAAmD;AAC/C,YAAMvE,MAAM,CAAC0E,KAAP,CAAa,OAAb,CAAN;AACH;;AACD,QAAI,aAAaJ,MAAb,IAAuB,CAACE,KAAK,CAACC,OAAN,CAAcF,KAAd,CAA5B,EAAkD;AAC9C,YAAMvE,MAAM,CAAC0E,KAAP,CAAa,OAAb,CAAN;AACH;AACJ,GAjFoB;AAkFrBR,EAAAA,cAAc,EAAE,0BAAW;AACvB,SAAKS,WAAL,GAAmBhF,CAAC,CAAC,OAAD,CAAD,CAAWmE,QAAX,CAAoB9C,mBAApB,CAAnB;AACA,SAAK6C,QAAL,GAAgBe,MAAhB,CAAuB,KAAKD,WAA5B;AACH,GArFoB;AAsFrBR,EAAAA,WAAW,EAAE,uBAAW;AACpB,QAAIU,SAAS,GAAGpE,YAAY,CAACC,aAAa,CAACoE,IAAf,EAAqB,KAAKC,IAA1B,CAA5B;AACAnF,IAAAA,YAAY,CAACoF,EAAb,CAAgB,KAAKnB,QAAL,EAAhB,EAAiCgB,SAAjC,EAA4C,KAAKI,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAA5C;AACH,GAzFoB;AA0FrBD,EAAAA,YAAY,EAAE,sBAASE,CAAT,EAAY;AACtB,QAAIC,gBAAgB,GAAG,KAAKC,SAAL,IAAkB,KAAKA,SAAL,CAAeC,gBAAf,CAAgCH,CAAhC,CAAlB,IAAwD,CAAC,KAAKb,MAAL,CAAY,UAAZ,CAAhF;;AACA,QAAIc,gBAAJ,EAAsB;AAClBD,MAAAA,CAAC,CAACI,eAAF;AACH;AACJ,GA/FoB;AAgGrBC,EAAAA,aAAa,EAAE,uBAASlB,MAAT,EAAiB;AAC5B,QAAIC,KAAK,GAAG,KAAKD,MAAL,CAAYA,MAAZ,CAAZ;AACA,SAAKF,SAAL,CAAeE,MAAf,IAAyBC,KAAK,CAACkB,KAAN,EAAzB;AACH,GAnGoB;AAoGrBC,EAAAA,OAAO,EAAE,mBAAW;AAChB,SAAKpE,QAAL;;AACA,SAAKqE,aAAL;;AACA,SAAKH,aAAL,CAAmB,SAAnB;;AACA,SAAKA,aAAL,CAAmB,QAAnB;;AACA,SAAKH,SAAL,GAAiB,IAAIvE,SAAS,CAAC,KAAKwD,MAAL,CAAY,UAAZ,CAAD,CAAb,CAAwC,IAAxC,EAA8C,KAAKK,WAAnD,CAAjB;;AACA,SAAKiB,iBAAL,CAAuB,QAAvB,EAAiC,KAAKxB,SAAL,CAAejC,OAAhD,EAAyD,KAAKiC,SAAL,CAAe7B,MAAxE;AACH,GA3GoB;AA4GrBoD,EAAAA,aAAa,EAAE,yBAAW;AACtB,QAAIE,OAAJ;;AACA,QAAI,KAAKvB,MAAL,CAAY,UAAZ,CAAJ,EAA6B;AACzBuB,MAAAA,OAAO,GAAGlG,CAAC,CAAC,OAAD,CAAD,CAAWmE,QAAX,CAAoB7C,gBAApB,CAAV;AACA,WAAK4C,QAAL,GAAgBe,MAAhB,CAAuBiB,OAAvB;AACH,KAHD,MAGO;AACHA,MAAAA,OAAO,GAAG,KAAKhC,QAAL,GAAgBiC,IAAhB,CAAqB,MAAM7E,gBAA3B,CAAV;AACA4E,MAAAA,OAAO,CAACE,MAAR;AACH;AACJ,GArHoB;AAsHrBC,EAAAA,MAAM,EAAE,kBAAW;AACf,SAAKC,gBAAL;;AACA,QAAI,KAAKZ,SAAT,EAAoB;AAChB,WAAKA,SAAL,CAAea,KAAf;AACH;;AACD,SAAKb,SAAL,GAAiB,IAAjB;AACA,SAAKtB,gBAAL,GAAwBlE,OAAO,CAACmE,OAAR,EAAxB;AACA,SAAKmC,eAAL,CAAqB,QAArB,EAA+B;AAC3B3E,MAAAA,SAAS,EAAE,IADgB;AAE3BC,MAAAA,SAAS,EAAE;AAFgB,KAA/B;AAIA,WAAO,KAAK2E,oBAAZ;AACH,GAlIoB;AAmIrBC,EAAAA,cAAc,EAAE,wBAASC,IAAT,EAAe;AAC3B,QAAIC,IAAI,GAAGD,IAAI,CAACC,IAAhB;AACA,QAAIC,SAAS,GAAG,KAAKC,gBAArB;AACA,SAAKA,gBAAL,GAAwB,IAAxB;;AACA,YAAQF,IAAR;AACI,WAAK,UAAL;AACI,aAAKZ,aAAL;;AACA,aAAKrE,QAAL,CAAcgF,IAAd;AACA;;AACJ,WAAK,OAAL;AACA,WAAK,QAAL;AACI,aAAKhF,QAAL,CAAcgF,IAAd;;AACA,aAAKI,iBAAL;;AACA;;AACJ,WAAK,UAAL;AACI,aAAKN,oBAAL,GAA4B,IAA5B;;AACA,aAAKO,WAAL;;AACA;;AACJ,WAAK,KAAL;AACA,WAAK,QAAL;AACI3G,QAAAA,MAAM,CAAC4G,GAAP,CAAW,OAAX;AACA;;AACJ,WAAK,QAAL;AACI,aAAKhB,iBAAL,CAAuB,cAAvB;;AACA;;AACJ,WAAK,QAAL;AACI,aAAKA,iBAAL,CAAuB,cAAvB;;AACA;;AACJ,WAAK,MAAL;AACI,aAAKA,iBAAL,CAAuB,YAAvB;;AACA;;AACJ,WAAK,MAAL;AACI,aAAKA,iBAAL,CAAuB,eAAvB;;AACA;;AACJ,WAAK,UAAL;AACI,aAAKA,iBAAL,CAAuB,gBAAvB,EAAyC,KAAKxB,SAAL,CAAejC,OAAxD,EAAiE,KAAKiC,SAAL,CAAe7B,MAAhF;;AACA;;AACJ,WAAK,YAAL;AACI,aAAKqD,iBAAL,CAAuB,gBAAvB;;AACA;;AACJ,WAAK,SAAL;AACA,WAAK,QAAL;AACI,aAAK3B,YAAL,CAAkBsC,IAAlB;;AACA,YAAIM,SAAS,GAAG,KAAKzC,SAAL,CAAemC,IAAf,CAAhB;;AACA,aAAKf,aAAL,CAAmBe,IAAnB;;AACA,aAAKX,iBAAL,CAAuB,WAAWzF,QAAQ,CAACoG,IAAD,CAA1C,EAAkDC,SAAS,GAAGA,SAAS,CAACM,OAAb,GAAuBD,SAAlF,EAA6FL,SAAS,GAAGA,SAAS,CAACO,KAAb,GAAqB,KAAK3C,SAAL,CAAemC,IAAf,CAA3H,EAAiJS,IAAjJ,CAAuJ,UAASC,MAAT,EAAiB;AACpK,cAAIT,SAAJ,EAAe;AACXA,YAAAA,SAAS,CAACxC,OAAV,CAAkBiD,MAAlB;AACH;AACJ,SAJD;;AAKA;;AACJ,WAAK,eAAL;AACI,aAAKrB,iBAAL,CAAuB,eAAvB,EAAwC,KAAKxB,SAAL,CAAejC,OAAvD,EAAgE,KAAKiC,SAAL,CAAejC,OAA/E;;AACA;;AACJ,WAAK,SAAL;AACA,WAAK,WAAL;AACA,WAAK,eAAL;AACA,WAAK,iBAAL;AACA,WAAK,cAAL;AACA,WAAK,gBAAL;AACA,WAAK,SAAL;AACI;;AACJ;AACI,aAAKb,QAAL,CAAc4F,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;AA3DR;AA6DH,GApMoB;AAqMrBC,EAAAA,kBAAkB,EAAE,4BAASC,OAAT,EAAkB;AAClC,QAAIA,OAAJ,EAAa;AACT,WAAKX,iBAAL;AACH;AACJ,GAzMoB;AA0MrBA,EAAAA,iBAAiB,EAAE,6BAAW;AAC1B,SAAKd,iBAAL,CAAuB,kBAAvB;AACH,GA5MoB;AA6MrBA,EAAAA,iBAAiB,EAAE,2BAASW,IAAT,EAAe;AAC9B,QAAIjD,OAAO,GAAG,GAAGmC,KAAH,CAAS6B,IAAT,CAAcH,SAAd,EAAyB1B,KAAzB,CAA+B,CAA/B,CAAd;AACA,QAAI8B,kBAAkB,GAAG,KAAKnB,oBAA9B;AACA,SAAKrC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBiD,IAAtB,CAA2B,YAAW;AAC1D,UAAI,CAAC,KAAK3B,SAAN,IAAmBkC,kBAAvB,EAA2C;AACvC,eAAO1H,OAAO,CAACmE,OAAR,EAAP;AACH;;AACD,aAAO,KAAKqB,SAAL,CAAekB,IAAf,EAAqBW,KAArB,CAA2B,KAAK7B,SAAhC,EAA2C/B,OAA3C,EAAoD0D,IAApD,CAAyD,UAASC,MAAT,EAAiB;AAC7EA,QAAAA,MAAM,GAAG1G,WAAW,CAAC0G,MAAD,CAApB;AACA,YAAIO,YAAY,GAAGP,MAAM,CAAC,CAAD,CAAzB;;AACA,YAAIO,YAAY,IAAI,CAAC,KAAKC,SAA1B,EAAqC;AACjC,eAAKC,mBAAL;AACH;;AACD,eAAOT,MAAM,CAAC,CAAD,CAAb;AACH,OAP+D,CAO9D/B,IAP8D,CAOzD,IAPyD,CAAzD,CAAP;AAQH,KAZkD,CAYjDA,IAZiD,CAY5C,IAZ4C,CAA3B,CAAxB;AAaA,WAAO,KAAKnB,gBAAZ;AACH,GA9NoB;AA+NrB2D,EAAAA,mBAAmB,EAAE,+BAAW;AAC5B,SAAKC,qBAAL,CAA2B,SAA3B,EAAsC;AAClCC,MAAAA,WAAW,EAAE,KAAKvC,SAAL,CAAewC,GAAf;AADqB,KAAtC;AAGH,GAnOoB;AAoOrBC,EAAAA,oBAAoB,EAAE,gCAAW;AAC7B,SAAKH,qBAAL,CAA2B,WAA3B;AACH,GAtOoB;AAuOrBxB,EAAAA,eAAe,EAAE,yBAASI,IAAT,EAAehC,KAAf,EAAsB;AACnC,SAAKwD,6BAAL,CAAmCxB,IAAnC,EAAyChC,KAAzC;AACH,GAzOoB;AA0OrByD,EAAAA,SAAS,EAAE,mBAASC,MAAT,EAAiB;AACxB,WAAO,KAAKC,YAAL,CAAkB,SAAlB,EAA6BD,MAA7B,CAAP;AACH,GA5OoB;AA6OrBE,EAAAA,YAAY,EAAE,sBAASF,MAAT,EAAiB;AAC3B,WAAO,KAAKG,eAAL,CAAqB,SAArB,EAAgCH,MAAhC,CAAP;AACH,GA/OoB;AAgPrBI,EAAAA,QAAQ,EAAE,kBAASC,KAAT,EAAgB;AACtB,WAAO,KAAKJ,YAAL,CAAkB,QAAlB,EAA4BI,KAA5B,CAAP;AACH,GAlPoB;AAmPrBC,EAAAA,WAAW,EAAE,qBAASD,KAAT,EAAgB;AACzB,WAAO,KAAKF,eAAL,CAAqB,QAArB,EAA+BE,KAA/B,CAAP;AACH,GArPoB;AAsPrBJ,EAAAA,YAAY,EAAE,sBAASM,UAAT,EAAqBC,WAArB,EAAkC;AAC5C,QAAIC,WAAW,GAAG,KAAKpE,MAAL,CAAYkE,UAAZ,CAAlB;AACA,QAAIG,YAAY,GAAGpI,WAAW,CAACkI,WAAD,CAA9B;AACAC,IAAAA,WAAW,CAACE,IAAZ,CAAiB1B,KAAjB,CAAuBwB,WAAvB,EAAoCC,YAApC;AACA,WAAO,KAAKE,yBAAL,CAA+BL,UAA/B,EAA2CE,WAA3C,EAAwDC,YAAxD,EAAsE,EAAtE,CAAP;AACH,GA3PoB;AA4PrBP,EAAAA,eAAe,EAAE,yBAASI,UAAT,EAAqBM,aAArB,EAAoC;AACjD,QAAIJ,WAAW,GAAG,KAAKpE,MAAL,CAAYkE,UAAZ,CAAlB;AACA,QAAIO,cAAc,GAAGxI,WAAW,CAACuI,aAAD,CAAhC;AACA1I,IAAAA,IAAI,CAAC2I,cAAD,EAAkB,UAASC,aAAT,EAAwBF,aAAxB,EAAuC;AACzD,UAAIG,KAAK,GAAGzI,SAAS,CAACsI,aAAD,CAAT,GAA2BA,aAA3B,GAA2CxI,OAAO,CAACwI,aAAD,EAAgBJ,WAAhB,CAA9D;;AACA,UAAI,CAAC,CAAD,KAAOO,KAAX,EAAkB;AACd,YAAIC,QAAQ,GAAGR,WAAW,CAACS,MAAZ,CAAmBF,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B,CAAf;AACAF,QAAAA,cAAc,CAACI,MAAf,CAAsBH,aAAtB,EAAqC,CAArC,EAAwCE,QAAxC;AACH,OAHD,MAGO;AACH,cAAMlJ,MAAM,CAAC4G,GAAP,CAAW,OAAX,EAAoBzG,QAAQ,CAACqI,UAAU,CAACY,SAAX,CAAqB,CAArB,EAAwBZ,UAAU,CAACa,MAAX,GAAoB,CAA5C,CAAD,CAA5B,EAA8EP,aAA9E,CAAN;AACH;AACJ,KARG,CAAJ;AASA,WAAO,KAAKD,yBAAL,CAA+BL,UAA/B,EAA2CE,WAA3C,EAAwD,EAAxD,EAA4DK,cAA5D,CAAP;AACH,GAzQoB;AA0QrBF,EAAAA,yBAAyB,EAAE,mCAASL,UAAT,EAAqBE,WAArB,EAAkCC,YAAlC,EAAgDI,cAAhD,EAAgE;AACvF,WAAOjJ,WAAW,CAAC,IAAID,OAAJ,CAAY,UAASmE,OAAT,EAAkB;AAC7C,WAAKyC,gBAAL,GAAwB;AACpBzC,QAAAA,OAAO,EAAEA,OADW;AAEpB+C,QAAAA,KAAK,EAAE4B,YAFa;AAGpB7B,QAAAA,OAAO,EAAEiC;AAHW,OAAxB;AAKA,WAAKzE,MAAL,CAAYkE,UAAZ,EAAwBE,WAAxB;AACH,KAP8B,CAO7BxD,IAP6B,CAOxB,IAPwB,CAAZ,EAOL8B,IAPK,CAOC,UAASC,MAAT,EAAiB;AACjC,aAAOA,MAAM,IAAI,MAAMA,MAAM,CAACoC,MAAvB,GAAgCpC,MAAM,CAAC,CAAD,CAAtC,GAA4CA,MAAnD;AACH,KATkB,CAAD,EASb,IATa,CAAlB;AAUH;AArRoB,CAAf,CAAV;AAuRAlH,iBAAiB,CAAC,OAAD,EAAUoB,GAAV,CAAjB;AACA,eAAeA,GAAf","sourcesContent":["/**\r\n * DevExtreme (esm/ui/map.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../core/renderer\";\r\nimport eventsEngine from \"../events/core/events_engine\";\r\nimport Promise from \"../core/polyfills/promise\";\r\nimport {\r\n    fromPromise\r\n} from \"../core/utils/deferred\";\r\nimport registerComponent from \"../core/component_registrator\";\r\nimport errors from \"./widget/ui.errors\";\r\nimport devices from \"../core/devices\";\r\nimport Widget from \"./widget/ui.widget\";\r\nimport {\r\n    titleize\r\n} from \"../core/utils/inflector\";\r\nimport {\r\n    each\r\n} from \"../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../core/utils/extend\";\r\nimport {\r\n    inArray,\r\n    wrapToArray\r\n} from \"../core/utils/array\";\r\nimport {\r\n    isNumeric\r\n} from \"../core/utils/type\";\r\nimport {\r\n    addNamespace\r\n} from \"../events/utils/index\";\r\nimport pointerEvents from \"../events/pointer\";\r\nimport googleStatic from \"./map/provider.google_static\";\r\nimport google from \"./map/provider.dynamic.google\";\r\nimport bing from \"./map/provider.dynamic.bing\";\r\nvar PROVIDERS = {\r\n    googleStatic: googleStatic,\r\n    google: google,\r\n    bing: bing\r\n};\r\nvar MAP_CLASS = \"dx-map\";\r\nvar MAP_CONTAINER_CLASS = \"dx-map-container\";\r\nvar MAP_SHIELD_CLASS = \"dx-map-shield\";\r\nvar NATIVE_CLICK_CLASS = \"dx-native-click\";\r\nvar Map = Widget.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            bounds: {\r\n                northEast: null,\r\n                southWest: null\r\n            },\r\n            center: {\r\n                lat: 0,\r\n                lng: 0\r\n            },\r\n            zoom: 1,\r\n            width: 300,\r\n            height: 300,\r\n            type: \"roadmap\",\r\n            provider: \"google\",\r\n            autoAdjust: true,\r\n            markers: [],\r\n            markerIconSrc: null,\r\n            onMarkerAdded: null,\r\n            onMarkerRemoved: null,\r\n            routes: [],\r\n            onRouteAdded: null,\r\n            onRouteRemoved: null,\r\n            key: {\r\n                bing: \"\",\r\n                google: \"\",\r\n                googleStatic: \"\"\r\n            },\r\n            apiKey: {\r\n                bing: \"\",\r\n                google: \"\",\r\n                googleStatic: \"\"\r\n            },\r\n            controls: false,\r\n            onReady: null,\r\n            onUpdated: null,\r\n            onClick: null\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: function() {\r\n                return \"desktop\" === devices.real().deviceType && !devices.isSimulator()\r\n            },\r\n            options: {\r\n                focusStateEnabled: true\r\n            }\r\n        }])\r\n    },\r\n    _setDeprecatedOptions: function() {\r\n        this.callBase();\r\n        extend(this._deprecatedOptions, {\r\n            key: {\r\n                since: \"20.2\",\r\n                alias: \"apiKey\"\r\n            }\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this.$element().addClass(MAP_CLASS).addClass(NATIVE_CLICK_CLASS);\r\n        this._lastAsyncAction = Promise.resolve();\r\n        this._checkOption(\"provider\");\r\n        this._checkOption(\"markers\");\r\n        this._checkOption(\"routes\");\r\n        this._initContainer();\r\n        this._grabEvents();\r\n        this._rendered = {}\r\n    },\r\n    _useTemplates: function() {\r\n        return false\r\n    },\r\n    _checkOption: function(option) {\r\n        var value = this.option(option);\r\n        if (\"markers\" === option && !Array.isArray(value)) {\r\n            throw errors.Error(\"E1022\")\r\n        }\r\n        if (\"routes\" === option && !Array.isArray(value)) {\r\n            throw errors.Error(\"E1023\")\r\n        }\r\n    },\r\n    _initContainer: function() {\r\n        this._$container = $(\"<div>\").addClass(MAP_CONTAINER_CLASS);\r\n        this.$element().append(this._$container)\r\n    },\r\n    _grabEvents: function() {\r\n        var eventName = addNamespace(pointerEvents.down, this.NAME);\r\n        eventsEngine.on(this.$element(), eventName, this._cancelEvent.bind(this))\r\n    },\r\n    _cancelEvent: function(e) {\r\n        var cancelByProvider = this._provider && this._provider.isEventsCanceled(e) && !this.option(\"disabled\");\r\n        if (cancelByProvider) {\r\n            e.stopPropagation()\r\n        }\r\n    },\r\n    _saveRendered: function(option) {\r\n        var value = this.option(option);\r\n        this._rendered[option] = value.slice()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._renderShield();\r\n        this._saveRendered(\"markers\");\r\n        this._saveRendered(\"routes\");\r\n        this._provider = new(PROVIDERS[this.option(\"provider\")])(this, this._$container);\r\n        this._queueAsyncAction(\"render\", this._rendered.markers, this._rendered.routes)\r\n    },\r\n    _renderShield: function() {\r\n        var $shield;\r\n        if (this.option(\"disabled\")) {\r\n            $shield = $(\"<div>\").addClass(MAP_SHIELD_CLASS);\r\n            this.$element().append($shield)\r\n        } else {\r\n            $shield = this.$element().find(\".\" + MAP_SHIELD_CLASS);\r\n            $shield.remove()\r\n        }\r\n    },\r\n    _clean: function() {\r\n        this._cleanFocusState();\r\n        if (this._provider) {\r\n            this._provider.clean()\r\n        }\r\n        this._provider = null;\r\n        this._lastAsyncAction = Promise.resolve();\r\n        this.setOptionSilent(\"bounds\", {\r\n            northEast: null,\r\n            southWest: null\r\n        });\r\n        delete this._suppressAsyncAction\r\n    },\r\n    _optionChanged: function(args) {\r\n        var name = args.name;\r\n        var changeBag = this._optionChangeBag;\r\n        this._optionChangeBag = null;\r\n        switch (name) {\r\n            case \"disabled\":\r\n                this._renderShield();\r\n                this.callBase(args);\r\n                break;\r\n            case \"width\":\r\n            case \"height\":\r\n                this.callBase(args);\r\n                this._dimensionChanged();\r\n                break;\r\n            case \"provider\":\r\n                this._suppressAsyncAction = true;\r\n                this._invalidate();\r\n                break;\r\n            case \"key\":\r\n            case \"apiKey\":\r\n                errors.log(\"W1001\");\r\n                break;\r\n            case \"bounds\":\r\n                this._queueAsyncAction(\"updateBounds\");\r\n                break;\r\n            case \"center\":\r\n                this._queueAsyncAction(\"updateCenter\");\r\n                break;\r\n            case \"zoom\":\r\n                this._queueAsyncAction(\"updateZoom\");\r\n                break;\r\n            case \"type\":\r\n                this._queueAsyncAction(\"updateMapType\");\r\n                break;\r\n            case \"controls\":\r\n                this._queueAsyncAction(\"updateControls\", this._rendered.markers, this._rendered.routes);\r\n                break;\r\n            case \"autoAdjust\":\r\n                this._queueAsyncAction(\"adjustViewport\");\r\n                break;\r\n            case \"markers\":\r\n            case \"routes\":\r\n                this._checkOption(name);\r\n                var prevValue = this._rendered[name];\r\n                this._saveRendered(name);\r\n                this._queueAsyncAction(\"update\" + titleize(name), changeBag ? changeBag.removed : prevValue, changeBag ? changeBag.added : this._rendered[name]).then((function(result) {\r\n                    if (changeBag) {\r\n                        changeBag.resolve(result)\r\n                    }\r\n                }));\r\n                break;\r\n            case \"markerIconSrc\":\r\n                this._queueAsyncAction(\"updateMarkers\", this._rendered.markers, this._rendered.markers);\r\n                break;\r\n            case \"onReady\":\r\n            case \"onUpdated\":\r\n            case \"onMarkerAdded\":\r\n            case \"onMarkerRemoved\":\r\n            case \"onRouteAdded\":\r\n            case \"onRouteRemoved\":\r\n            case \"onClick\":\r\n                break;\r\n            default:\r\n                this.callBase.apply(this, arguments)\r\n        }\r\n    },\r\n    _visibilityChanged: function(visible) {\r\n        if (visible) {\r\n            this._dimensionChanged()\r\n        }\r\n    },\r\n    _dimensionChanged: function() {\r\n        this._queueAsyncAction(\"updateDimensions\")\r\n    },\r\n    _queueAsyncAction: function(name) {\r\n        var options = [].slice.call(arguments).slice(1);\r\n        var isActionSuppressed = this._suppressAsyncAction;\r\n        this._lastAsyncAction = this._lastAsyncAction.then(function() {\r\n            if (!this._provider || isActionSuppressed) {\r\n                return Promise.resolve()\r\n            }\r\n            return this._provider[name].apply(this._provider, options).then(function(result) {\r\n                result = wrapToArray(result);\r\n                var mapRefreshed = result[0];\r\n                if (mapRefreshed && !this._disposed) {\r\n                    this._triggerReadyAction()\r\n                }\r\n                return result[1]\r\n            }.bind(this))\r\n        }.bind(this));\r\n        return this._lastAsyncAction\r\n    },\r\n    _triggerReadyAction: function() {\r\n        this._createActionByOption(\"onReady\")({\r\n            originalMap: this._provider.map()\r\n        })\r\n    },\r\n    _triggerUpdateAction: function() {\r\n        this._createActionByOption(\"onUpdated\")()\r\n    },\r\n    setOptionSilent: function(name, value) {\r\n        this._setOptionWithoutOptionChange(name, value)\r\n    },\r\n    addMarker: function(marker) {\r\n        return this._addFunction(\"markers\", marker)\r\n    },\r\n    removeMarker: function(marker) {\r\n        return this._removeFunction(\"markers\", marker)\r\n    },\r\n    addRoute: function(route) {\r\n        return this._addFunction(\"routes\", route)\r\n    },\r\n    removeRoute: function(route) {\r\n        return this._removeFunction(\"routes\", route)\r\n    },\r\n    _addFunction: function(optionName, addingValue) {\r\n        var optionValue = this.option(optionName);\r\n        var addingValues = wrapToArray(addingValue);\r\n        optionValue.push.apply(optionValue, addingValues);\r\n        return this._partialArrayOptionChange(optionName, optionValue, addingValues, [])\r\n    },\r\n    _removeFunction: function(optionName, removingValue) {\r\n        var optionValue = this.option(optionName);\r\n        var removingValues = wrapToArray(removingValue);\r\n        each(removingValues, (function(removingIndex, removingValue) {\r\n            var index = isNumeric(removingValue) ? removingValue : inArray(removingValue, optionValue);\r\n            if (-1 !== index) {\r\n                var removing = optionValue.splice(index, 1)[0];\r\n                removingValues.splice(removingIndex, 1, removing)\r\n            } else {\r\n                throw errors.log(\"E1021\", titleize(optionName.substring(0, optionName.length - 1)), removingValue)\r\n            }\r\n        }));\r\n        return this._partialArrayOptionChange(optionName, optionValue, [], removingValues)\r\n    },\r\n    _partialArrayOptionChange: function(optionName, optionValue, addingValues, removingValues) {\r\n        return fromPromise(new Promise(function(resolve) {\r\n            this._optionChangeBag = {\r\n                resolve: resolve,\r\n                added: addingValues,\r\n                removed: removingValues\r\n            };\r\n            this.option(optionName, optionValue)\r\n        }.bind(this)).then((function(result) {\r\n            return result && 1 === result.length ? result[0] : result\r\n        })), this)\r\n    }\r\n});\r\nregisterComponent(\"dxMap\", Map);\r\nexport default Map;\r\n"]},"metadata":{},"sourceType":"module"}