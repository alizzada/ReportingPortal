{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/defer_rendering.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { TransitionExecutor } from \"../animation/transition_executor/transition_executor\";\nimport registerComponent from \"../core/component_registrator\";\nimport domAdapter from \"../core/dom_adapter\";\nimport $ from \"../core/renderer\";\nimport { noop, executeAsync } from \"../core/utils/common\";\nimport { Deferred, fromPromise } from \"../core/utils/deferred\";\nimport { extend } from \"../core/utils/extend\";\nimport { each } from \"../core/utils/iterator\";\nimport { isPromise } from \"../core/utils/type\";\nimport { getWindow, hasWindow } from \"../core/utils/window\";\nimport eventsEngine from \"../events/core/events_engine\";\nimport { triggerShownEvent } from \"../events/visibility_change\";\nimport LoadIndicator from \"./load_indicator\";\nimport Widget from \"./widget/ui.widget\";\nimport { getBoundingRect } from \"../core/utils/position\";\nvar window = getWindow();\nvar WIDGET_CLASS = \"dx-widget\";\nvar DEFER_RENDERING_CLASS = \"dx-deferrendering\";\nvar PENDING_RENDERING_CLASS = \"dx-pending-rendering\";\nvar PENDING_RENDERING_MANUAL_CLASS = \"dx-pending-rendering-manual\";\nvar PENDING_RENDERING_ACTIVE_CLASS = \"dx-pending-rendering-active\";\nvar VISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-visible-while-pending-rendering\";\nvar INVISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-invisible-while-pending-rendering\";\nvar LOADINDICATOR_CONTAINER_CLASS = \"dx-loadindicator-container\";\nvar DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS = \"dx-deferrendering-loadindicator-container\";\nvar DEFER_DEFER_RENDERING_LOAD_INDICATOR = \"dx-deferrendering-load-indicator\";\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\nvar ACTIONS = [\"onRendered\", \"onShown\"];\nvar DeferRendering = Widget.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      showLoadIndicator: false,\n      renderWhen: void 0,\n      animation: void 0,\n      staggerItemSelector: void 0,\n      onRendered: null,\n      onShown: null\n    });\n  },\n  _getAnonymousTemplateName: function _getAnonymousTemplateName() {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _init: function _init() {\n    this.transitionExecutor = new TransitionExecutor();\n\n    this._initElement();\n\n    this._initRender();\n\n    this._$initialContent = this.$element().clone().contents();\n\n    this._initActions();\n\n    this.callBase();\n  },\n  _initElement: function _initElement() {\n    this.$element().addClass(DEFER_RENDERING_CLASS);\n  },\n  _initRender: function _initRender() {\n    var that = this;\n    var $element = this.$element();\n    var renderWhen = this.option(\"renderWhen\");\n\n    var doRender = function doRender() {\n      return that._renderDeferredContent();\n    };\n\n    if (isPromise(renderWhen)) {\n      fromPromise(renderWhen).done(doRender);\n    } else {\n      $element.data(\"dx-render-delegate\", doRender);\n\n      if (void 0 === renderWhen) {\n        $element.addClass(PENDING_RENDERING_MANUAL_CLASS);\n      }\n    }\n  },\n  _initActions: function _initActions() {\n    var _this = this;\n\n    this._actions = {};\n    each(ACTIONS, function (_, action) {\n      _this._actions[action] = _this._createActionByOption(action) || noop;\n    });\n  },\n  _initMarkup: function _initMarkup() {\n    this.callBase();\n\n    if (!this._initContent) {\n      this._initContent = this._renderContent;\n\n      this._renderContent = function () {};\n    }\n\n    this._initContent();\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    this.$element().removeClass(WIDGET_CLASS);\n    this.$element().append(this._$initialContent);\n\n    this._setLoadingState();\n  },\n  _renderDeferredContent: function _renderDeferredContent() {\n    var that = this;\n    var $element = this.$element();\n    var result = new Deferred();\n    $element.removeClass(PENDING_RENDERING_MANUAL_CLASS);\n    $element.addClass(PENDING_RENDERING_ACTIVE_CLASS);\n\n    this._abortRenderTask();\n\n    this._renderTask = executeAsync(function () {\n      that._renderImpl().done(function () {\n        var shownArgs = {\n          element: $element\n        };\n\n        that._actions.onShown([shownArgs]);\n\n        result.resolve(shownArgs);\n      }).fail(function () {\n        result.rejectWith(result, arguments);\n      });\n    });\n    return result.promise();\n  },\n  _isElementInViewport: function _isElementInViewport(element) {\n    var rect = getBoundingRect(element);\n    return rect.bottom >= 0 && rect.right >= 0 && rect.top <= (window.innerHeight || domAdapter.getDocumentElement().clientHeight) && rect.left <= (window.innerWidth || domAdapter.getDocumentElement().clientWidth);\n  },\n  _animate: function _animate() {\n    var that = this;\n    var $element = this.$element();\n    var animation = hasWindow() && this.option(\"animation\");\n    var staggerItemSelector = this.option(\"staggerItemSelector\");\n    var animatePromise;\n    that.transitionExecutor.stop();\n\n    if (animation) {\n      if (staggerItemSelector) {\n        $element.find(staggerItemSelector).each(function () {\n          if (that._isElementInViewport(this)) {\n            that.transitionExecutor.enter($(this), animation);\n          }\n        });\n      } else {\n        that.transitionExecutor.enter($element, animation);\n      }\n\n      animatePromise = that.transitionExecutor.start();\n    } else {\n      animatePromise = new Deferred().resolve().promise();\n    }\n\n    return animatePromise;\n  },\n  _renderImpl: function _renderImpl() {\n    var $element = this.$element();\n    var renderedArgs = {\n      element: $element\n    };\n\n    var contentTemplate = this._getTemplate(this._templateManager.anonymousTemplateName);\n\n    if (contentTemplate) {\n      contentTemplate.render({\n        container: $element.empty(),\n        noModel: true\n      });\n    }\n\n    this._setRenderedState($element);\n\n    eventsEngine.trigger($element, \"dxcontentrendered\");\n\n    this._actions.onRendered([renderedArgs]);\n\n    this._isRendered = true;\n    return this._animate();\n  },\n  _setLoadingState: function _setLoadingState() {\n    var $element = this.$element();\n    var hasCustomLoadIndicator = !!$element.find(\".\" + VISIBLE_WHILE_PENDING_RENDERING_CLASS).length;\n    $element.addClass(PENDING_RENDERING_CLASS);\n\n    if (!hasCustomLoadIndicator) {\n      $element.children().addClass(INVISIBLE_WHILE_PENDING_RENDERING_CLASS);\n    }\n\n    if (this.option(\"showLoadIndicator\")) {\n      this._showLoadIndicator($element);\n    }\n  },\n  _showLoadIndicator: function _showLoadIndicator($container) {\n    this._$loadIndicator = new LoadIndicator($(\"<div>\"), {\n      visible: true\n    }).$element().addClass(DEFER_DEFER_RENDERING_LOAD_INDICATOR);\n    $(\"<div>\").addClass(LOADINDICATOR_CONTAINER_CLASS).addClass(DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS).append(this._$loadIndicator).appendTo($container);\n  },\n  _setRenderedState: function _setRenderedState() {\n    var $element = this.$element();\n\n    if (this._$loadIndicator) {\n      this._$loadIndicator.remove();\n    }\n\n    $element.removeClass(PENDING_RENDERING_CLASS);\n    $element.removeClass(PENDING_RENDERING_ACTIVE_CLASS);\n    triggerShownEvent($element.children());\n  },\n  _optionChanged: function _optionChanged(args) {\n    var value = args.value;\n    var previousValue = args.previousValue;\n\n    switch (args.name) {\n      case \"renderWhen\":\n        if (false === previousValue && true === value) {\n          this._renderOrAnimate();\n        } else if (true === previousValue && false === value) {\n          this.transitionExecutor.stop();\n\n          this._setLoadingState();\n        }\n\n        break;\n\n      case \"showLoadIndicator\":\n      case \"onRendered\":\n      case \"onShown\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _renderOrAnimate: function _renderOrAnimate() {\n    var result;\n\n    if (this._isRendered) {\n      this._setRenderedState();\n\n      result = this._animate();\n    } else {\n      result = this._renderDeferredContent();\n    }\n\n    return result;\n  },\n  renderContent: function renderContent() {\n    return this._renderOrAnimate();\n  },\n  _abortRenderTask: function _abortRenderTask() {\n    if (this._renderTask) {\n      this._renderTask.abort();\n\n      this._renderTask = void 0;\n    }\n  },\n  _dispose: function _dispose() {\n    this.transitionExecutor.stop(true);\n\n    this._abortRenderTask();\n\n    this._actions = void 0;\n    this._$initialContent = void 0;\n    this.callBase();\n  }\n});\nregisterComponent(\"dxDeferRendering\", DeferRendering);\nexport default DeferRendering;","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/ui/defer_rendering.js"],"names":["TransitionExecutor","registerComponent","domAdapter","$","noop","executeAsync","Deferred","fromPromise","extend","each","isPromise","getWindow","hasWindow","eventsEngine","triggerShownEvent","LoadIndicator","Widget","getBoundingRect","window","WIDGET_CLASS","DEFER_RENDERING_CLASS","PENDING_RENDERING_CLASS","PENDING_RENDERING_MANUAL_CLASS","PENDING_RENDERING_ACTIVE_CLASS","VISIBLE_WHILE_PENDING_RENDERING_CLASS","INVISIBLE_WHILE_PENDING_RENDERING_CLASS","LOADINDICATOR_CONTAINER_CLASS","DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS","DEFER_DEFER_RENDERING_LOAD_INDICATOR","ANONYMOUS_TEMPLATE_NAME","ACTIONS","DeferRendering","inherit","_getDefaultOptions","callBase","showLoadIndicator","renderWhen","animation","staggerItemSelector","onRendered","onShown","_getAnonymousTemplateName","_init","transitionExecutor","_initElement","_initRender","_$initialContent","$element","clone","contents","_initActions","addClass","that","option","doRender","_renderDeferredContent","done","data","_actions","_","action","_createActionByOption","_initMarkup","_initContent","_renderContent","_renderContentImpl","removeClass","append","_setLoadingState","result","_abortRenderTask","_renderTask","_renderImpl","shownArgs","element","resolve","fail","rejectWith","arguments","promise","_isElementInViewport","rect","bottom","right","top","innerHeight","getDocumentElement","clientHeight","left","innerWidth","clientWidth","_animate","animatePromise","stop","find","enter","start","renderedArgs","contentTemplate","_getTemplate","_templateManager","anonymousTemplateName","render","container","empty","noModel","_setRenderedState","trigger","_isRendered","hasCustomLoadIndicator","length","children","_showLoadIndicator","$container","_$loadIndicator","visible","appendTo","remove","_optionChanged","args","value","previousValue","name","_renderOrAnimate","renderContent","abort","_dispose"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/defer_rendering.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    TransitionExecutor\r\n} from \"../animation/transition_executor/transition_executor\";\r\nimport registerComponent from \"../core/component_registrator\";\r\nimport domAdapter from \"../core/dom_adapter\";\r\nimport $ from \"../core/renderer\";\r\nimport {\r\n    noop,\r\n    executeAsync\r\n} from \"../core/utils/common\";\r\nimport {\r\n    Deferred,\r\n    fromPromise\r\n} from \"../core/utils/deferred\";\r\nimport {\r\n    extend\r\n} from \"../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../core/utils/iterator\";\r\nimport {\r\n    isPromise\r\n} from \"../core/utils/type\";\r\nimport {\r\n    getWindow,\r\n    hasWindow\r\n} from \"../core/utils/window\";\r\nimport eventsEngine from \"../events/core/events_engine\";\r\nimport {\r\n    triggerShownEvent\r\n} from \"../events/visibility_change\";\r\nimport LoadIndicator from \"./load_indicator\";\r\nimport Widget from \"./widget/ui.widget\";\r\nimport {\r\n    getBoundingRect\r\n} from \"../core/utils/position\";\r\nvar window = getWindow();\r\nvar WIDGET_CLASS = \"dx-widget\";\r\nvar DEFER_RENDERING_CLASS = \"dx-deferrendering\";\r\nvar PENDING_RENDERING_CLASS = \"dx-pending-rendering\";\r\nvar PENDING_RENDERING_MANUAL_CLASS = \"dx-pending-rendering-manual\";\r\nvar PENDING_RENDERING_ACTIVE_CLASS = \"dx-pending-rendering-active\";\r\nvar VISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-visible-while-pending-rendering\";\r\nvar INVISIBLE_WHILE_PENDING_RENDERING_CLASS = \"dx-invisible-while-pending-rendering\";\r\nvar LOADINDICATOR_CONTAINER_CLASS = \"dx-loadindicator-container\";\r\nvar DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS = \"dx-deferrendering-loadindicator-container\";\r\nvar DEFER_DEFER_RENDERING_LOAD_INDICATOR = \"dx-deferrendering-load-indicator\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\r\nvar ACTIONS = [\"onRendered\", \"onShown\"];\r\nvar DeferRendering = Widget.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            showLoadIndicator: false,\r\n            renderWhen: void 0,\r\n            animation: void 0,\r\n            staggerItemSelector: void 0,\r\n            onRendered: null,\r\n            onShown: null\r\n        })\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _init: function() {\r\n        this.transitionExecutor = new TransitionExecutor;\r\n        this._initElement();\r\n        this._initRender();\r\n        this._$initialContent = this.$element().clone().contents();\r\n        this._initActions();\r\n        this.callBase()\r\n    },\r\n    _initElement: function() {\r\n        this.$element().addClass(DEFER_RENDERING_CLASS)\r\n    },\r\n    _initRender: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var renderWhen = this.option(\"renderWhen\");\r\n        var doRender = () => that._renderDeferredContent();\r\n        if (isPromise(renderWhen)) {\r\n            fromPromise(renderWhen).done(doRender)\r\n        } else {\r\n            $element.data(\"dx-render-delegate\", doRender);\r\n            if (void 0 === renderWhen) {\r\n                $element.addClass(PENDING_RENDERING_MANUAL_CLASS)\r\n            }\r\n        }\r\n    },\r\n    _initActions: function() {\r\n        this._actions = {};\r\n        each(ACTIONS, (_, action) => {\r\n            this._actions[action] = this._createActionByOption(action) || noop\r\n        })\r\n    },\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        if (!this._initContent) {\r\n            this._initContent = this._renderContent;\r\n            this._renderContent = () => {}\r\n        }\r\n        this._initContent()\r\n    },\r\n    _renderContentImpl: function() {\r\n        this.$element().removeClass(WIDGET_CLASS);\r\n        this.$element().append(this._$initialContent);\r\n        this._setLoadingState()\r\n    },\r\n    _renderDeferredContent: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var result = new Deferred;\r\n        $element.removeClass(PENDING_RENDERING_MANUAL_CLASS);\r\n        $element.addClass(PENDING_RENDERING_ACTIVE_CLASS);\r\n        this._abortRenderTask();\r\n        this._renderTask = executeAsync(() => {\r\n            that._renderImpl().done(() => {\r\n                var shownArgs = {\r\n                    element: $element\r\n                };\r\n                that._actions.onShown([shownArgs]);\r\n                result.resolve(shownArgs)\r\n            }).fail((function() {\r\n                result.rejectWith(result, arguments)\r\n            }))\r\n        });\r\n        return result.promise()\r\n    },\r\n    _isElementInViewport: function(element) {\r\n        var rect = getBoundingRect(element);\r\n        return rect.bottom >= 0 && rect.right >= 0 && rect.top <= (window.innerHeight || domAdapter.getDocumentElement().clientHeight) && rect.left <= (window.innerWidth || domAdapter.getDocumentElement().clientWidth)\r\n    },\r\n    _animate: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var animation = hasWindow() && this.option(\"animation\");\r\n        var staggerItemSelector = this.option(\"staggerItemSelector\");\r\n        var animatePromise;\r\n        that.transitionExecutor.stop();\r\n        if (animation) {\r\n            if (staggerItemSelector) {\r\n                $element.find(staggerItemSelector).each((function() {\r\n                    if (that._isElementInViewport(this)) {\r\n                        that.transitionExecutor.enter($(this), animation)\r\n                    }\r\n                }))\r\n            } else {\r\n                that.transitionExecutor.enter($element, animation)\r\n            }\r\n            animatePromise = that.transitionExecutor.start()\r\n        } else {\r\n            animatePromise = (new Deferred).resolve().promise()\r\n        }\r\n        return animatePromise\r\n    },\r\n    _renderImpl: function() {\r\n        var $element = this.$element();\r\n        var renderedArgs = {\r\n            element: $element\r\n        };\r\n        var contentTemplate = this._getTemplate(this._templateManager.anonymousTemplateName);\r\n        if (contentTemplate) {\r\n            contentTemplate.render({\r\n                container: $element.empty(),\r\n                noModel: true\r\n            })\r\n        }\r\n        this._setRenderedState($element);\r\n        eventsEngine.trigger($element, \"dxcontentrendered\");\r\n        this._actions.onRendered([renderedArgs]);\r\n        this._isRendered = true;\r\n        return this._animate()\r\n    },\r\n    _setLoadingState: function() {\r\n        var $element = this.$element();\r\n        var hasCustomLoadIndicator = !!$element.find(\".\" + VISIBLE_WHILE_PENDING_RENDERING_CLASS).length;\r\n        $element.addClass(PENDING_RENDERING_CLASS);\r\n        if (!hasCustomLoadIndicator) {\r\n            $element.children().addClass(INVISIBLE_WHILE_PENDING_RENDERING_CLASS)\r\n        }\r\n        if (this.option(\"showLoadIndicator\")) {\r\n            this._showLoadIndicator($element)\r\n        }\r\n    },\r\n    _showLoadIndicator: function($container) {\r\n        this._$loadIndicator = new LoadIndicator($(\"<div>\"), {\r\n            visible: true\r\n        }).$element().addClass(DEFER_DEFER_RENDERING_LOAD_INDICATOR);\r\n        $(\"<div>\").addClass(LOADINDICATOR_CONTAINER_CLASS).addClass(DEFER_RENDERING_LOADINDICATOR_CONTAINER_CLASS).append(this._$loadIndicator).appendTo($container)\r\n    },\r\n    _setRenderedState: function() {\r\n        var $element = this.$element();\r\n        if (this._$loadIndicator) {\r\n            this._$loadIndicator.remove()\r\n        }\r\n        $element.removeClass(PENDING_RENDERING_CLASS);\r\n        $element.removeClass(PENDING_RENDERING_ACTIVE_CLASS);\r\n        triggerShownEvent($element.children())\r\n    },\r\n    _optionChanged: function(args) {\r\n        var value = args.value;\r\n        var previousValue = args.previousValue;\r\n        switch (args.name) {\r\n            case \"renderWhen\":\r\n                if (false === previousValue && true === value) {\r\n                    this._renderOrAnimate()\r\n                } else if (true === previousValue && false === value) {\r\n                    this.transitionExecutor.stop();\r\n                    this._setLoadingState()\r\n                }\r\n                break;\r\n            case \"showLoadIndicator\":\r\n            case \"onRendered\":\r\n            case \"onShown\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _renderOrAnimate: function() {\r\n        var result;\r\n        if (this._isRendered) {\r\n            this._setRenderedState();\r\n            result = this._animate()\r\n        } else {\r\n            result = this._renderDeferredContent()\r\n        }\r\n        return result\r\n    },\r\n    renderContent: function() {\r\n        return this._renderOrAnimate()\r\n    },\r\n    _abortRenderTask: function() {\r\n        if (this._renderTask) {\r\n            this._renderTask.abort();\r\n            this._renderTask = void 0\r\n        }\r\n    },\r\n    _dispose: function() {\r\n        this.transitionExecutor.stop(true);\r\n        this._abortRenderTask();\r\n        this._actions = void 0;\r\n        this._$initialContent = void 0;\r\n        this.callBase()\r\n    }\r\n});\r\nregisterComponent(\"dxDeferRendering\", DeferRendering);\r\nexport default DeferRendering;\r\n"]},"metadata":{},"sourceType":"module"}