{"ast":null,"code":"import _defineProperty from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\n/**\r\n * DevExtreme (esm/ui/html_editor/ui.html_editor.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport { extend } from \"../../core/utils/extend\";\nimport { isDefined, isFunction } from \"../../core/utils/type\";\nimport { getPublicElement } from \"../../core/element\";\nimport { executeAsync, noop, ensureDefined, deferRender } from \"../../core/utils/common\";\nimport registerComponent from \"../../core/component_registrator\";\nimport { EmptyTemplate } from \"../../core/templates/empty_template\";\nimport Editor from \"../editor/editor\";\nimport Errors from \"../widget/ui.errors\";\nimport Callbacks from \"../../core/utils/callbacks\";\nimport { Deferred } from \"../../core/utils/deferred\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { addNamespace } from \"../../events/utils/index\";\nimport { Event as dxEvent } from \"../../events/index\";\nimport scrollEvents from \"../scroll_view/ui.events.emitter.gesture.scroll\";\nimport { prepareScrollData } from \"../text_box/utils.scroll\";\nimport QuillRegistrator from \"./quill_registrator\";\nimport \"./converters/delta\";\nimport ConverterController from \"./converterController\";\nimport getWordMatcher from \"./matchers/wordLists\";\nimport FormDialog from \"./ui/formDialog\";\nvar HTML_EDITOR_CLASS = \"dx-htmleditor\";\nvar QUILL_CONTAINER_CLASS = \"dx-quill-container\";\nvar QUILL_CLIPBOARD_CLASS = \"ql-clipboard\";\nvar HTML_EDITOR_SUBMIT_ELEMENT_CLASS = \"dx-htmleditor-submit-element\";\nvar HTML_EDITOR_CONTENT_CLASS = \"dx-htmleditor-content\";\nvar MARKDOWN_VALUE_TYPE = \"markdown\";\nvar ANONYMOUS_TEMPLATE_NAME = \"htmlContent\";\nvar HtmlEditor = Editor.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      focusStateEnabled: true,\n      valueType: \"html\",\n      placeholder: \"\",\n      toolbar: null,\n      variables: null,\n      mediaResizing: null,\n      mentions: null,\n      customizeModules: null,\n      formDialogOptions: null,\n      stylingMode: \"outlined\"\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n    this._cleanCallback = Callbacks();\n    this._contentInitializedCallback = Callbacks();\n  },\n  _getAnonymousTemplateName: function _getAnonymousTemplateName() {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _initTemplates: function _initTemplates() {\n    this._templateManager.addDefaultTemplates(_defineProperty({}, ANONYMOUS_TEMPLATE_NAME, new EmptyTemplate()));\n\n    this.callBase();\n  },\n  _focusTarget: function _focusTarget() {\n    return this._getContent();\n  },\n  _getContent: function _getContent() {\n    return this.$element().find(\".\".concat(HTML_EDITOR_CONTENT_CLASS));\n  },\n  _focusInHandler: function _focusInHandler(_ref) {\n    var relatedTarget = _ref.relatedTarget;\n\n    if (this._shouldSkipFocusEvent(relatedTarget)) {\n      return;\n    }\n\n    this._toggleFocusClass(true, this.$element());\n\n    this.callBase.apply(this, arguments);\n  },\n  _focusOutHandler: function _focusOutHandler(_ref2) {\n    var relatedTarget = _ref2.relatedTarget;\n\n    if (this._shouldSkipFocusEvent(relatedTarget)) {\n      return;\n    }\n\n    this._toggleFocusClass(false, this.$element());\n\n    this.callBase.apply(this, arguments);\n  },\n  _shouldSkipFocusEvent: function _shouldSkipFocusEvent(relatedTarget) {\n    return $(relatedTarget).hasClass(QUILL_CLIPBOARD_CLASS);\n  },\n  _initMarkup: function _initMarkup() {\n    this._$htmlContainer = $(\"<div>\").addClass(QUILL_CONTAINER_CLASS);\n    this.$element().attr(\"role\", \"application\").addClass(HTML_EDITOR_CLASS).wrapInner(this._$htmlContainer);\n\n    this._renderStylingMode();\n\n    var template = this._getTemplate(ANONYMOUS_TEMPLATE_NAME);\n\n    this._$templateResult = template && template.render({\n      container: getPublicElement(this._$htmlContainer),\n      noModel: true,\n      transclude: true\n    });\n\n    this._renderSubmitElement();\n\n    this.callBase();\n\n    this._updateContainerMarkup();\n  },\n  _renderSubmitElement: function _renderSubmitElement() {\n    this._$submitElement = $(\"<textarea>\").addClass(HTML_EDITOR_SUBMIT_ELEMENT_CLASS).attr(\"hidden\", true).appendTo(this.$element());\n\n    this._setSubmitValue(this.option(\"value\"));\n  },\n  _setSubmitValue: function _setSubmitValue(value) {\n    this._getSubmitElement().val(value);\n  },\n  _getSubmitElement: function _getSubmitElement() {\n    return this._$submitElement;\n  },\n  _updateContainerMarkup: function _updateContainerMarkup() {\n    var markup = this.option(\"value\");\n\n    if (this._isMarkdownValue()) {\n      this._prepareMarkdownConverter();\n\n      markup = this._markdownConverter.toHtml(markup);\n    }\n\n    if (markup) {\n      this._$htmlContainer.html(markup);\n    }\n  },\n  _prepareMarkdownConverter: function _prepareMarkdownConverter() {\n    var MarkdownConverter = ConverterController.getConverter(\"markdown\");\n\n    if (MarkdownConverter) {\n      this._markdownConverter = new MarkdownConverter();\n    } else {\n      throw Errors.Error(\"E1051\", \"markdown\");\n    }\n  },\n  _render: function _render() {\n    this._prepareConverters();\n\n    this.callBase();\n  },\n  _prepareQuillRegistrator: function _prepareQuillRegistrator() {\n    if (!this._quillRegistrator) {\n      this._quillRegistrator = new QuillRegistrator();\n    }\n  },\n  _getRegistrator: function _getRegistrator() {\n    this._prepareQuillRegistrator();\n\n    return this._quillRegistrator;\n  },\n  _prepareConverters: function _prepareConverters() {\n    if (!this._deltaConverter) {\n      var DeltaConverter = ConverterController.getConverter(\"delta\");\n\n      if (DeltaConverter) {\n        this._deltaConverter = new DeltaConverter();\n      }\n    }\n\n    if (this.option(\"valueType\") === MARKDOWN_VALUE_TYPE && !this._markdownConverter) {\n      this._prepareMarkdownConverter();\n    }\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    this._contentRenderedDeferred = new Deferred();\n\n    var renderContentPromise = this._contentRenderedDeferred.promise();\n\n    this.callBase();\n\n    this._renderHtmlEditor();\n\n    this._renderFormDialog();\n\n    this._addKeyPressHandler();\n\n    return renderContentPromise;\n  },\n  _attachFocusEvents: function _attachFocusEvents() {\n    deferRender(this.callBase.bind(this));\n  },\n  _addKeyPressHandler: function _addKeyPressHandler() {\n    var keyDownEvent = addNamespace(\"keydown\", \"\".concat(this.NAME, \"TextChange\"));\n    eventsEngine.on(this._$htmlContainer, keyDownEvent, this._keyDownHandler.bind(this));\n  },\n  _keyDownHandler: function _keyDownHandler(e) {\n    this._saveValueChangeEvent(e);\n  },\n  _renderHtmlEditor: function _renderHtmlEditor() {\n    var _this = this;\n\n    var customizeModules = this.option(\"customizeModules\");\n\n    var modulesConfig = this._getModulesConfig();\n\n    if (isFunction(customizeModules)) {\n      customizeModules(modulesConfig);\n    }\n\n    this._quillInstance = this._getRegistrator().createEditor(this._$htmlContainer[0], {\n      placeholder: this.option(\"placeholder\"),\n      readOnly: this.option(\"readOnly\") || this.option(\"disabled\"),\n      modules: modulesConfig,\n      theme: \"basic\"\n    });\n\n    this._deltaConverter.setQuillInstance(this._quillInstance);\n\n    this._textChangeHandlerWithContext = this._textChangeHandler.bind(this);\n\n    this._quillInstance.on(\"text-change\", this._textChangeHandlerWithContext);\n\n    this._renderScrollHandler();\n\n    if (this._hasTranscludedContent()) {\n      this._updateContentTask = executeAsync(function () {\n        _this._applyTranscludedContent();\n      });\n    } else {\n      this._finalizeContentRendering();\n    }\n  },\n  _renderScrollHandler: function _renderScrollHandler() {\n    var $scrollContainer = this._getContent();\n\n    var initScrollData = prepareScrollData($scrollContainer);\n    eventsEngine.on($scrollContainer, addNamespace(scrollEvents.init, this.NAME), initScrollData, noop);\n  },\n  _applyTranscludedContent: function _applyTranscludedContent() {\n    var valueOption = this.option(\"value\");\n\n    if (!isDefined(valueOption)) {\n      var html = this._deltaConverter.toHtml();\n\n      var newDelta = this._quillInstance.clipboard.convert({\n        html: html\n      });\n\n      if (newDelta.ops.length) {\n        this._quillInstance.setContents(newDelta);\n\n        return;\n      }\n    }\n\n    this._finalizeContentRendering();\n  },\n  _hasTranscludedContent: function _hasTranscludedContent() {\n    return this._$templateResult && this._$templateResult.length;\n  },\n  _getModulesConfig: function _getModulesConfig() {\n    var _this2 = this;\n\n    var quill = this._getRegistrator().getQuill();\n\n    var wordListMatcher = getWordMatcher(quill);\n    var modulesConfig = extend({}, {\n      table: true,\n      toolbar: this._getModuleConfigByOption(\"toolbar\"),\n      variables: this._getModuleConfigByOption(\"variables\"),\n      resizing: this._getModuleConfigByOption(\"mediaResizing\"),\n      mentions: this._getModuleConfigByOption(\"mentions\"),\n      uploader: {\n        onDrop: function onDrop(e) {\n          return _this2._saveValueChangeEvent(dxEvent(e));\n        },\n        imageBlot: \"extendedImage\"\n      },\n      keyboard: {\n        onKeydown: function onKeydown(e) {\n          return _this2._saveValueChangeEvent(dxEvent(e));\n        }\n      },\n      clipboard: {\n        onPaste: function onPaste(e) {\n          return _this2._saveValueChangeEvent(dxEvent(e));\n        },\n        onCut: function onCut(e) {\n          return _this2._saveValueChangeEvent(dxEvent(e));\n        },\n        matchers: [[\"p.MsoListParagraphCxSpFirst\", wordListMatcher], [\"p.MsoListParagraphCxSpMiddle\", wordListMatcher], [\"p.MsoListParagraphCxSpLast\", wordListMatcher]]\n      }\n    }, this._getCustomModules());\n    return modulesConfig;\n  },\n  _getModuleConfigByOption: function _getModuleConfigByOption(userOptionName) {\n    var optionValue = this.option(userOptionName);\n    var config = {};\n\n    if (!isDefined(optionValue)) {\n      return;\n    }\n\n    if (Array.isArray(optionValue)) {\n      config[userOptionName] = optionValue;\n    } else {\n      config = optionValue;\n    }\n\n    return extend(this._getBaseModuleConfig(), config);\n  },\n  _getBaseModuleConfig: function _getBaseModuleConfig() {\n    return {\n      editorInstance: this\n    };\n  },\n  _getCustomModules: function _getCustomModules() {\n    var _this3 = this;\n\n    var modules = {};\n\n    var moduleNames = this._getRegistrator().getRegisteredModuleNames();\n\n    moduleNames.forEach(function (modulePath) {\n      modules[modulePath] = _this3._getBaseModuleConfig();\n    });\n    return modules;\n  },\n  _textChangeHandler: function _textChangeHandler(newDelta, oldDelta, source) {\n    var htmlMarkup = this._deltaConverter.toHtml();\n\n    var convertedValue = this._isMarkdownValue() ? this._updateValueByType(MARKDOWN_VALUE_TYPE, htmlMarkup) : htmlMarkup;\n    var currentValue = this.option(\"value\");\n\n    if (currentValue !== convertedValue && !this._isNullValueConverted(currentValue, convertedValue)) {\n      this._isEditorUpdating = true;\n      this.option(\"value\", convertedValue);\n    }\n\n    this._finalizeContentRendering();\n  },\n  _isNullValueConverted: function _isNullValueConverted(currentValue, convertedValue) {\n    return null === currentValue && \"\" === convertedValue;\n  },\n  _finalizeContentRendering: function _finalizeContentRendering() {\n    if (this._contentRenderedDeferred) {\n      this.clearHistory();\n\n      this._contentInitializedCallback.fire();\n\n      this._contentRenderedDeferred.resolve();\n\n      this._contentRenderedDeferred = void 0;\n    }\n  },\n  _updateValueByType: function _updateValueByType(valueType, value) {\n    var converter = this._markdownConverter;\n\n    if (!isDefined(converter)) {\n      return;\n    }\n\n    var currentValue = ensureDefined(value, this.option(\"value\"));\n    return valueType === MARKDOWN_VALUE_TYPE ? converter.toMarkdown(currentValue) : converter.toHtml(currentValue);\n  },\n  _isMarkdownValue: function _isMarkdownValue() {\n    return this.option(\"valueType\") === MARKDOWN_VALUE_TYPE;\n  },\n  _resetEnabledState: function _resetEnabledState() {\n    if (this._quillInstance) {\n      var isEnabled = !(this.option(\"readOnly\") || this.option(\"disabled\"));\n\n      this._quillInstance.enable(isEnabled);\n    }\n  },\n  _renderFormDialog: function _renderFormDialog() {\n    var userOptions = extend(true, {\n      width: \"auto\",\n      height: \"auto\",\n      closeOnOutsideClick: true\n    }, this.option(\"formDialogOptions\"));\n    this._formDialog = new FormDialog(this, userOptions);\n  },\n  _getStylingModePrefix: function _getStylingModePrefix() {\n    return \"dx-htmleditor-\";\n  },\n  _getQuillContainer: function _getQuillContainer() {\n    return this._$htmlContainer;\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"value\":\n        if (this._quillInstance) {\n          if (this._isEditorUpdating) {\n            this._isEditorUpdating = false;\n          } else {\n            var updatedValue = this._isMarkdownValue() ? this._updateValueByType(\"HTML\", args.value) : args.value;\n\n            this._updateHtmlContent(updatedValue);\n          }\n        } else {\n          this._$htmlContainer.html(args.value);\n        }\n\n        this._setSubmitValue(args.value);\n\n        this.callBase(args);\n        break;\n\n      case \"placeholder\":\n      case \"variables\":\n      case \"toolbar\":\n      case \"mentions\":\n      case \"customizeModules\":\n        this._invalidate();\n\n        break;\n\n      case \"valueType\":\n        this._prepareConverters();\n\n        var newValue = this._updateValueByType(args.value);\n\n        if (\"html\" === args.value && this._quillInstance) {\n          this._updateHtmlContent(newValue);\n        } else {\n          this.option(\"value\", newValue);\n        }\n\n        break;\n\n      case \"stylingMode\":\n        this._renderStylingMode();\n\n        break;\n\n      case \"readOnly\":\n      case \"disabled\":\n        this.callBase(args);\n\n        this._resetEnabledState();\n\n        break;\n\n      case \"formDialogOptions\":\n        this._renderFormDialog();\n\n        break;\n\n      case \"mediaResizing\":\n        if (!args.previousValue || !args.value) {\n          this._invalidate();\n        } else {\n          this._quillInstance.getModule(\"resizing\").option(args.name, args.value);\n        }\n\n        break;\n\n      case \"width\":\n        this.callBase(args);\n\n        this._repaintToolbar();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _repaintToolbar: function _repaintToolbar() {\n    var toolbar = this._quillInstance.getModule(\"toolbar\");\n\n    toolbar && toolbar.repaint();\n  },\n  _updateHtmlContent: function _updateHtmlContent(html) {\n    var newDelta = this._quillInstance.clipboard.convert({\n      html: html\n    });\n\n    this._quillInstance.setContents(newDelta);\n  },\n  _clean: function _clean() {\n    if (this._quillInstance) {\n      eventsEngine.off(this._getContent(), \".\".concat(this.NAME));\n\n      this._quillInstance.off(\"text-change\", this._textChangeHandlerWithContext);\n\n      this._cleanCallback.fire();\n    }\n\n    this._abortUpdateContentTask();\n\n    this._cleanCallback.empty();\n\n    this._contentInitializedCallback.empty();\n\n    this.callBase();\n  },\n  _abortUpdateContentTask: function _abortUpdateContentTask() {\n    if (this._updateContentTask) {\n      this._updateContentTask.abort();\n\n      this._updateContentTask = void 0;\n    }\n  },\n  _applyQuillMethod: function _applyQuillMethod(methodName, args) {\n    if (this._quillInstance) {\n      return this._quillInstance[methodName].apply(this._quillInstance, args);\n    }\n  },\n  _applyQuillHistoryMethod: function _applyQuillHistoryMethod(methodName) {\n    if (this._quillInstance && this._quillInstance.history) {\n      this._quillInstance.history[methodName]();\n    }\n  },\n  addCleanCallback: function addCleanCallback(callback) {\n    this._cleanCallback.add(callback);\n  },\n  addContentInitializedCallback: function addContentInitializedCallback(callback) {\n    this._contentInitializedCallback.add(callback);\n  },\n  register: function register(components) {\n    this._getRegistrator().registerModules(components);\n\n    if (this._quillInstance) {\n      this.repaint();\n    }\n  },\n  get: function get(modulePath) {\n    return this._getRegistrator().getQuill().import(modulePath);\n  },\n  getModule: function getModule(moduleName) {\n    return this._applyQuillMethod(\"getModule\", arguments);\n  },\n  getQuillInstance: function getQuillInstance() {\n    return this._quillInstance;\n  },\n  getSelection: function getSelection(focus) {\n    return this._applyQuillMethod(\"getSelection\", arguments);\n  },\n  setSelection: function setSelection(index, length) {\n    this._applyQuillMethod(\"setSelection\", arguments);\n  },\n  getText: function getText(index, length) {\n    return this._applyQuillMethod(\"getText\", arguments);\n  },\n  format: function format(formatName, formatValue) {\n    this._applyQuillMethod(\"format\", arguments);\n  },\n  formatText: function formatText(index, length, formatName, formatValue) {\n    this._applyQuillMethod(\"formatText\", arguments);\n  },\n  formatLine: function formatLine(index, length, formatName, formatValue) {\n    this._applyQuillMethod(\"formatLine\", arguments);\n  },\n  getFormat: function getFormat(index, length) {\n    return this._applyQuillMethod(\"getFormat\", arguments);\n  },\n  removeFormat: function removeFormat(index, length) {\n    return this._applyQuillMethod(\"removeFormat\", arguments);\n  },\n  clearHistory: function clearHistory() {\n    this._applyQuillHistoryMethod(\"clear\");\n  },\n  undo: function undo() {\n    this._applyQuillHistoryMethod(\"undo\");\n  },\n  redo: function redo() {\n    this._applyQuillHistoryMethod(\"redo\");\n  },\n  getLength: function getLength() {\n    return this._applyQuillMethod(\"getLength\");\n  },\n  getBounds: function getBounds(index, length) {\n    return this._applyQuillMethod(\"getBounds\", arguments);\n  },\n  delete: function _delete(index, length) {\n    this._applyQuillMethod(\"deleteText\", arguments);\n  },\n  insertText: function insertText(index, text, formats) {\n    this._applyQuillMethod(\"insertText\", arguments);\n  },\n  insertEmbed: function insertEmbed(index, type, config) {\n    this._applyQuillMethod(\"insertEmbed\", arguments);\n  },\n  showFormDialog: function showFormDialog(formConfig) {\n    return this._formDialog.show(formConfig);\n  },\n  formDialogOption: function formDialogOption(optionName, optionValue) {\n    return this._formDialog.popupOption.apply(this._formDialog, arguments);\n  },\n  focus: function focus() {\n    this.callBase();\n\n    this._applyQuillMethod(\"focus\");\n  },\n  blur: function blur() {\n    this._applyQuillMethod(\"blur\");\n  }\n});\nregisterComponent(\"dxHtmlEditor\", HtmlEditor);\nexport default HtmlEditor;","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/ui/html_editor/ui.html_editor.js"],"names":["$","extend","isDefined","isFunction","getPublicElement","executeAsync","noop","ensureDefined","deferRender","registerComponent","EmptyTemplate","Editor","Errors","Callbacks","Deferred","eventsEngine","addNamespace","Event","dxEvent","scrollEvents","prepareScrollData","QuillRegistrator","ConverterController","getWordMatcher","FormDialog","HTML_EDITOR_CLASS","QUILL_CONTAINER_CLASS","QUILL_CLIPBOARD_CLASS","HTML_EDITOR_SUBMIT_ELEMENT_CLASS","HTML_EDITOR_CONTENT_CLASS","MARKDOWN_VALUE_TYPE","ANONYMOUS_TEMPLATE_NAME","HtmlEditor","inherit","_getDefaultOptions","callBase","focusStateEnabled","valueType","placeholder","toolbar","variables","mediaResizing","mentions","customizeModules","formDialogOptions","stylingMode","_init","_cleanCallback","_contentInitializedCallback","_getAnonymousTemplateName","_initTemplates","_templateManager","addDefaultTemplates","_focusTarget","_getContent","$element","find","concat","_focusInHandler","_ref","relatedTarget","_shouldSkipFocusEvent","_toggleFocusClass","apply","arguments","_focusOutHandler","_ref2","hasClass","_initMarkup","_$htmlContainer","addClass","attr","wrapInner","_renderStylingMode","template","_getTemplate","_$templateResult","render","container","noModel","transclude","_renderSubmitElement","_updateContainerMarkup","_$submitElement","appendTo","_setSubmitValue","option","value","_getSubmitElement","val","markup","_isMarkdownValue","_prepareMarkdownConverter","_markdownConverter","toHtml","html","MarkdownConverter","getConverter","Error","_render","_prepareConverters","_prepareQuillRegistrator","_quillRegistrator","_getRegistrator","_deltaConverter","DeltaConverter","_renderContentImpl","_contentRenderedDeferred","renderContentPromise","promise","_renderHtmlEditor","_renderFormDialog","_addKeyPressHandler","_attachFocusEvents","bind","keyDownEvent","NAME","on","_keyDownHandler","e","_saveValueChangeEvent","modulesConfig","_getModulesConfig","_quillInstance","createEditor","readOnly","modules","theme","setQuillInstance","_textChangeHandlerWithContext","_textChangeHandler","_renderScrollHandler","_hasTranscludedContent","_updateContentTask","_applyTranscludedContent","_finalizeContentRendering","$scrollContainer","initScrollData","init","valueOption","newDelta","clipboard","convert","ops","length","setContents","quill","getQuill","wordListMatcher","table","_getModuleConfigByOption","resizing","uploader","onDrop","imageBlot","keyboard","onKeydown","onPaste","onCut","matchers","_getCustomModules","userOptionName","optionValue","config","Array","isArray","_getBaseModuleConfig","editorInstance","moduleNames","getRegisteredModuleNames","forEach","modulePath","oldDelta","source","htmlMarkup","convertedValue","_updateValueByType","currentValue","_isNullValueConverted","_isEditorUpdating","clearHistory","fire","resolve","converter","toMarkdown","_resetEnabledState","isEnabled","enable","userOptions","width","height","closeOnOutsideClick","_formDialog","_getStylingModePrefix","_getQuillContainer","_optionChanged","args","name","updatedValue","_updateHtmlContent","_invalidate","newValue","previousValue","getModule","_repaintToolbar","repaint","_clean","off","_abortUpdateContentTask","empty","abort","_applyQuillMethod","methodName","_applyQuillHistoryMethod","history","addCleanCallback","callback","add","addContentInitializedCallback","register","components","registerModules","get","import","moduleName","getQuillInstance","getSelection","focus","setSelection","index","getText","format","formatName","formatValue","formatText","formatLine","getFormat","removeFormat","undo","redo","getLength","getBounds","delete","insertText","text","formats","insertEmbed","type","showFormDialog","formConfig","show","formDialogOption","optionName","popupOption","blur"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/html_editor/ui.html_editor.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    isDefined,\r\n    isFunction\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport {\r\n    executeAsync,\r\n    noop,\r\n    ensureDefined,\r\n    deferRender\r\n} from \"../../core/utils/common\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport {\r\n    EmptyTemplate\r\n} from \"../../core/templates/empty_template\";\r\nimport Editor from \"../editor/editor\";\r\nimport Errors from \"../widget/ui.errors\";\r\nimport Callbacks from \"../../core/utils/callbacks\";\r\nimport {\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    addNamespace\r\n} from \"../../events/utils/index\";\r\nimport {\r\n    Event as dxEvent\r\n} from \"../../events/index\";\r\nimport scrollEvents from \"../scroll_view/ui.events.emitter.gesture.scroll\";\r\nimport {\r\n    prepareScrollData\r\n} from \"../text_box/utils.scroll\";\r\nimport QuillRegistrator from \"./quill_registrator\";\r\nimport \"./converters/delta\";\r\nimport ConverterController from \"./converterController\";\r\nimport getWordMatcher from \"./matchers/wordLists\";\r\nimport FormDialog from \"./ui/formDialog\";\r\nvar HTML_EDITOR_CLASS = \"dx-htmleditor\";\r\nvar QUILL_CONTAINER_CLASS = \"dx-quill-container\";\r\nvar QUILL_CLIPBOARD_CLASS = \"ql-clipboard\";\r\nvar HTML_EDITOR_SUBMIT_ELEMENT_CLASS = \"dx-htmleditor-submit-element\";\r\nvar HTML_EDITOR_CONTENT_CLASS = \"dx-htmleditor-content\";\r\nvar MARKDOWN_VALUE_TYPE = \"markdown\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"htmlContent\";\r\nvar HtmlEditor = Editor.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            focusStateEnabled: true,\r\n            valueType: \"html\",\r\n            placeholder: \"\",\r\n            toolbar: null,\r\n            variables: null,\r\n            mediaResizing: null,\r\n            mentions: null,\r\n            customizeModules: null,\r\n            formDialogOptions: null,\r\n            stylingMode: \"outlined\"\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._cleanCallback = Callbacks();\r\n        this._contentInitializedCallback = Callbacks()\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _initTemplates: function() {\r\n        this._templateManager.addDefaultTemplates({\r\n            [ANONYMOUS_TEMPLATE_NAME]: new EmptyTemplate\r\n        });\r\n        this.callBase()\r\n    },\r\n    _focusTarget: function() {\r\n        return this._getContent()\r\n    },\r\n    _getContent: function() {\r\n        return this.$element().find(\".\".concat(HTML_EDITOR_CONTENT_CLASS))\r\n    },\r\n    _focusInHandler: function(_ref) {\r\n        var {\r\n            relatedTarget: relatedTarget\r\n        } = _ref;\r\n        if (this._shouldSkipFocusEvent(relatedTarget)) {\r\n            return\r\n        }\r\n        this._toggleFocusClass(true, this.$element());\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _focusOutHandler: function(_ref2) {\r\n        var {\r\n            relatedTarget: relatedTarget\r\n        } = _ref2;\r\n        if (this._shouldSkipFocusEvent(relatedTarget)) {\r\n            return\r\n        }\r\n        this._toggleFocusClass(false, this.$element());\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _shouldSkipFocusEvent: function(relatedTarget) {\r\n        return $(relatedTarget).hasClass(QUILL_CLIPBOARD_CLASS)\r\n    },\r\n    _initMarkup: function() {\r\n        this._$htmlContainer = $(\"<div>\").addClass(QUILL_CONTAINER_CLASS);\r\n        this.$element().attr(\"role\", \"application\").addClass(HTML_EDITOR_CLASS).wrapInner(this._$htmlContainer);\r\n        this._renderStylingMode();\r\n        var template = this._getTemplate(ANONYMOUS_TEMPLATE_NAME);\r\n        this._$templateResult = template && template.render({\r\n            container: getPublicElement(this._$htmlContainer),\r\n            noModel: true,\r\n            transclude: true\r\n        });\r\n        this._renderSubmitElement();\r\n        this.callBase();\r\n        this._updateContainerMarkup()\r\n    },\r\n    _renderSubmitElement: function() {\r\n        this._$submitElement = $(\"<textarea>\").addClass(HTML_EDITOR_SUBMIT_ELEMENT_CLASS).attr(\"hidden\", true).appendTo(this.$element());\r\n        this._setSubmitValue(this.option(\"value\"))\r\n    },\r\n    _setSubmitValue: function(value) {\r\n        this._getSubmitElement().val(value)\r\n    },\r\n    _getSubmitElement: function() {\r\n        return this._$submitElement\r\n    },\r\n    _updateContainerMarkup: function() {\r\n        var markup = this.option(\"value\");\r\n        if (this._isMarkdownValue()) {\r\n            this._prepareMarkdownConverter();\r\n            markup = this._markdownConverter.toHtml(markup)\r\n        }\r\n        if (markup) {\r\n            this._$htmlContainer.html(markup)\r\n        }\r\n    },\r\n    _prepareMarkdownConverter: function() {\r\n        var MarkdownConverter = ConverterController.getConverter(\"markdown\");\r\n        if (MarkdownConverter) {\r\n            this._markdownConverter = new MarkdownConverter\r\n        } else {\r\n            throw Errors.Error(\"E1051\", \"markdown\")\r\n        }\r\n    },\r\n    _render: function() {\r\n        this._prepareConverters();\r\n        this.callBase()\r\n    },\r\n    _prepareQuillRegistrator: function() {\r\n        if (!this._quillRegistrator) {\r\n            this._quillRegistrator = new QuillRegistrator\r\n        }\r\n    },\r\n    _getRegistrator: function() {\r\n        this._prepareQuillRegistrator();\r\n        return this._quillRegistrator\r\n    },\r\n    _prepareConverters: function() {\r\n        if (!this._deltaConverter) {\r\n            var DeltaConverter = ConverterController.getConverter(\"delta\");\r\n            if (DeltaConverter) {\r\n                this._deltaConverter = new DeltaConverter\r\n            }\r\n        }\r\n        if (this.option(\"valueType\") === MARKDOWN_VALUE_TYPE && !this._markdownConverter) {\r\n            this._prepareMarkdownConverter()\r\n        }\r\n    },\r\n    _renderContentImpl: function() {\r\n        this._contentRenderedDeferred = new Deferred;\r\n        var renderContentPromise = this._contentRenderedDeferred.promise();\r\n        this.callBase();\r\n        this._renderHtmlEditor();\r\n        this._renderFormDialog();\r\n        this._addKeyPressHandler();\r\n        return renderContentPromise\r\n    },\r\n    _attachFocusEvents: function() {\r\n        deferRender(this.callBase.bind(this))\r\n    },\r\n    _addKeyPressHandler: function() {\r\n        var keyDownEvent = addNamespace(\"keydown\", \"\".concat(this.NAME, \"TextChange\"));\r\n        eventsEngine.on(this._$htmlContainer, keyDownEvent, this._keyDownHandler.bind(this))\r\n    },\r\n    _keyDownHandler: function(e) {\r\n        this._saveValueChangeEvent(e)\r\n    },\r\n    _renderHtmlEditor: function() {\r\n        var customizeModules = this.option(\"customizeModules\");\r\n        var modulesConfig = this._getModulesConfig();\r\n        if (isFunction(customizeModules)) {\r\n            customizeModules(modulesConfig)\r\n        }\r\n        this._quillInstance = this._getRegistrator().createEditor(this._$htmlContainer[0], {\r\n            placeholder: this.option(\"placeholder\"),\r\n            readOnly: this.option(\"readOnly\") || this.option(\"disabled\"),\r\n            modules: modulesConfig,\r\n            theme: \"basic\"\r\n        });\r\n        this._deltaConverter.setQuillInstance(this._quillInstance);\r\n        this._textChangeHandlerWithContext = this._textChangeHandler.bind(this);\r\n        this._quillInstance.on(\"text-change\", this._textChangeHandlerWithContext);\r\n        this._renderScrollHandler();\r\n        if (this._hasTranscludedContent()) {\r\n            this._updateContentTask = executeAsync(() => {\r\n                this._applyTranscludedContent()\r\n            })\r\n        } else {\r\n            this._finalizeContentRendering()\r\n        }\r\n    },\r\n    _renderScrollHandler: function() {\r\n        var $scrollContainer = this._getContent();\r\n        var initScrollData = prepareScrollData($scrollContainer);\r\n        eventsEngine.on($scrollContainer, addNamespace(scrollEvents.init, this.NAME), initScrollData, noop)\r\n    },\r\n    _applyTranscludedContent: function() {\r\n        var valueOption = this.option(\"value\");\r\n        if (!isDefined(valueOption)) {\r\n            var html = this._deltaConverter.toHtml();\r\n            var newDelta = this._quillInstance.clipboard.convert({\r\n                html: html\r\n            });\r\n            if (newDelta.ops.length) {\r\n                this._quillInstance.setContents(newDelta);\r\n                return\r\n            }\r\n        }\r\n        this._finalizeContentRendering()\r\n    },\r\n    _hasTranscludedContent: function() {\r\n        return this._$templateResult && this._$templateResult.length\r\n    },\r\n    _getModulesConfig: function() {\r\n        var quill = this._getRegistrator().getQuill();\r\n        var wordListMatcher = getWordMatcher(quill);\r\n        var modulesConfig = extend({}, {\r\n            table: true,\r\n            toolbar: this._getModuleConfigByOption(\"toolbar\"),\r\n            variables: this._getModuleConfigByOption(\"variables\"),\r\n            resizing: this._getModuleConfigByOption(\"mediaResizing\"),\r\n            mentions: this._getModuleConfigByOption(\"mentions\"),\r\n            uploader: {\r\n                onDrop: e => this._saveValueChangeEvent(dxEvent(e)),\r\n                imageBlot: \"extendedImage\"\r\n            },\r\n            keyboard: {\r\n                onKeydown: e => this._saveValueChangeEvent(dxEvent(e))\r\n            },\r\n            clipboard: {\r\n                onPaste: e => this._saveValueChangeEvent(dxEvent(e)),\r\n                onCut: e => this._saveValueChangeEvent(dxEvent(e)),\r\n                matchers: [\r\n                    [\"p.MsoListParagraphCxSpFirst\", wordListMatcher],\r\n                    [\"p.MsoListParagraphCxSpMiddle\", wordListMatcher],\r\n                    [\"p.MsoListParagraphCxSpLast\", wordListMatcher]\r\n                ]\r\n            }\r\n        }, this._getCustomModules());\r\n        return modulesConfig\r\n    },\r\n    _getModuleConfigByOption: function(userOptionName) {\r\n        var optionValue = this.option(userOptionName);\r\n        var config = {};\r\n        if (!isDefined(optionValue)) {\r\n            return\r\n        }\r\n        if (Array.isArray(optionValue)) {\r\n            config[userOptionName] = optionValue\r\n        } else {\r\n            config = optionValue\r\n        }\r\n        return extend(this._getBaseModuleConfig(), config)\r\n    },\r\n    _getBaseModuleConfig: function() {\r\n        return {\r\n            editorInstance: this\r\n        }\r\n    },\r\n    _getCustomModules: function() {\r\n        var modules = {};\r\n        var moduleNames = this._getRegistrator().getRegisteredModuleNames();\r\n        moduleNames.forEach(modulePath => {\r\n            modules[modulePath] = this._getBaseModuleConfig()\r\n        });\r\n        return modules\r\n    },\r\n    _textChangeHandler: function(newDelta, oldDelta, source) {\r\n        var htmlMarkup = this._deltaConverter.toHtml();\r\n        var convertedValue = this._isMarkdownValue() ? this._updateValueByType(MARKDOWN_VALUE_TYPE, htmlMarkup) : htmlMarkup;\r\n        var currentValue = this.option(\"value\");\r\n        if (currentValue !== convertedValue && !this._isNullValueConverted(currentValue, convertedValue)) {\r\n            this._isEditorUpdating = true;\r\n            this.option(\"value\", convertedValue)\r\n        }\r\n        this._finalizeContentRendering()\r\n    },\r\n    _isNullValueConverted: function(currentValue, convertedValue) {\r\n        return null === currentValue && \"\" === convertedValue\r\n    },\r\n    _finalizeContentRendering: function() {\r\n        if (this._contentRenderedDeferred) {\r\n            this.clearHistory();\r\n            this._contentInitializedCallback.fire();\r\n            this._contentRenderedDeferred.resolve();\r\n            this._contentRenderedDeferred = void 0\r\n        }\r\n    },\r\n    _updateValueByType: function(valueType, value) {\r\n        var converter = this._markdownConverter;\r\n        if (!isDefined(converter)) {\r\n            return\r\n        }\r\n        var currentValue = ensureDefined(value, this.option(\"value\"));\r\n        return valueType === MARKDOWN_VALUE_TYPE ? converter.toMarkdown(currentValue) : converter.toHtml(currentValue)\r\n    },\r\n    _isMarkdownValue: function() {\r\n        return this.option(\"valueType\") === MARKDOWN_VALUE_TYPE\r\n    },\r\n    _resetEnabledState: function() {\r\n        if (this._quillInstance) {\r\n            var isEnabled = !(this.option(\"readOnly\") || this.option(\"disabled\"));\r\n            this._quillInstance.enable(isEnabled)\r\n        }\r\n    },\r\n    _renderFormDialog: function() {\r\n        var userOptions = extend(true, {\r\n            width: \"auto\",\r\n            height: \"auto\",\r\n            closeOnOutsideClick: true\r\n        }, this.option(\"formDialogOptions\"));\r\n        this._formDialog = new FormDialog(this, userOptions)\r\n    },\r\n    _getStylingModePrefix: function() {\r\n        return \"dx-htmleditor-\"\r\n    },\r\n    _getQuillContainer: function() {\r\n        return this._$htmlContainer\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"value\":\r\n                if (this._quillInstance) {\r\n                    if (this._isEditorUpdating) {\r\n                        this._isEditorUpdating = false\r\n                    } else {\r\n                        var updatedValue = this._isMarkdownValue() ? this._updateValueByType(\"HTML\", args.value) : args.value;\r\n                        this._updateHtmlContent(updatedValue)\r\n                    }\r\n                } else {\r\n                    this._$htmlContainer.html(args.value)\r\n                }\r\n                this._setSubmitValue(args.value);\r\n                this.callBase(args);\r\n                break;\r\n            case \"placeholder\":\r\n            case \"variables\":\r\n            case \"toolbar\":\r\n            case \"mentions\":\r\n            case \"customizeModules\":\r\n                this._invalidate();\r\n                break;\r\n            case \"valueType\":\r\n                this._prepareConverters();\r\n                var newValue = this._updateValueByType(args.value);\r\n                if (\"html\" === args.value && this._quillInstance) {\r\n                    this._updateHtmlContent(newValue)\r\n                } else {\r\n                    this.option(\"value\", newValue)\r\n                }\r\n                break;\r\n            case \"stylingMode\":\r\n                this._renderStylingMode();\r\n                break;\r\n            case \"readOnly\":\r\n            case \"disabled\":\r\n                this.callBase(args);\r\n                this._resetEnabledState();\r\n                break;\r\n            case \"formDialogOptions\":\r\n                this._renderFormDialog();\r\n                break;\r\n            case \"mediaResizing\":\r\n                if (!args.previousValue || !args.value) {\r\n                    this._invalidate()\r\n                } else {\r\n                    this._quillInstance.getModule(\"resizing\").option(args.name, args.value)\r\n                }\r\n                break;\r\n            case \"width\":\r\n                this.callBase(args);\r\n                this._repaintToolbar();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _repaintToolbar: function() {\r\n        var toolbar = this._quillInstance.getModule(\"toolbar\");\r\n        toolbar && toolbar.repaint()\r\n    },\r\n    _updateHtmlContent: function(html) {\r\n        var newDelta = this._quillInstance.clipboard.convert({\r\n            html: html\r\n        });\r\n        this._quillInstance.setContents(newDelta)\r\n    },\r\n    _clean: function() {\r\n        if (this._quillInstance) {\r\n            eventsEngine.off(this._getContent(), \".\".concat(this.NAME));\r\n            this._quillInstance.off(\"text-change\", this._textChangeHandlerWithContext);\r\n            this._cleanCallback.fire()\r\n        }\r\n        this._abortUpdateContentTask();\r\n        this._cleanCallback.empty();\r\n        this._contentInitializedCallback.empty();\r\n        this.callBase()\r\n    },\r\n    _abortUpdateContentTask: function() {\r\n        if (this._updateContentTask) {\r\n            this._updateContentTask.abort();\r\n            this._updateContentTask = void 0\r\n        }\r\n    },\r\n    _applyQuillMethod(methodName, args) {\r\n        if (this._quillInstance) {\r\n            return this._quillInstance[methodName].apply(this._quillInstance, args)\r\n        }\r\n    },\r\n    _applyQuillHistoryMethod(methodName) {\r\n        if (this._quillInstance && this._quillInstance.history) {\r\n            this._quillInstance.history[methodName]()\r\n        }\r\n    },\r\n    addCleanCallback(callback) {\r\n        this._cleanCallback.add(callback)\r\n    },\r\n    addContentInitializedCallback(callback) {\r\n        this._contentInitializedCallback.add(callback)\r\n    },\r\n    register: function(components) {\r\n        this._getRegistrator().registerModules(components);\r\n        if (this._quillInstance) {\r\n            this.repaint()\r\n        }\r\n    },\r\n    get: function(modulePath) {\r\n        return this._getRegistrator().getQuill().import(modulePath)\r\n    },\r\n    getModule: function(moduleName) {\r\n        return this._applyQuillMethod(\"getModule\", arguments)\r\n    },\r\n    getQuillInstance: function() {\r\n        return this._quillInstance\r\n    },\r\n    getSelection: function(focus) {\r\n        return this._applyQuillMethod(\"getSelection\", arguments)\r\n    },\r\n    setSelection: function(index, length) {\r\n        this._applyQuillMethod(\"setSelection\", arguments)\r\n    },\r\n    getText: function(index, length) {\r\n        return this._applyQuillMethod(\"getText\", arguments)\r\n    },\r\n    format: function(formatName, formatValue) {\r\n        this._applyQuillMethod(\"format\", arguments)\r\n    },\r\n    formatText: function(index, length, formatName, formatValue) {\r\n        this._applyQuillMethod(\"formatText\", arguments)\r\n    },\r\n    formatLine: function(index, length, formatName, formatValue) {\r\n        this._applyQuillMethod(\"formatLine\", arguments)\r\n    },\r\n    getFormat: function(index, length) {\r\n        return this._applyQuillMethod(\"getFormat\", arguments)\r\n    },\r\n    removeFormat: function(index, length) {\r\n        return this._applyQuillMethod(\"removeFormat\", arguments)\r\n    },\r\n    clearHistory: function() {\r\n        this._applyQuillHistoryMethod(\"clear\")\r\n    },\r\n    undo: function() {\r\n        this._applyQuillHistoryMethod(\"undo\")\r\n    },\r\n    redo: function() {\r\n        this._applyQuillHistoryMethod(\"redo\")\r\n    },\r\n    getLength: function() {\r\n        return this._applyQuillMethod(\"getLength\")\r\n    },\r\n    getBounds: function(index, length) {\r\n        return this._applyQuillMethod(\"getBounds\", arguments)\r\n    },\r\n    delete: function(index, length) {\r\n        this._applyQuillMethod(\"deleteText\", arguments)\r\n    },\r\n    insertText: function(index, text, formats) {\r\n        this._applyQuillMethod(\"insertText\", arguments)\r\n    },\r\n    insertEmbed: function(index, type, config) {\r\n        this._applyQuillMethod(\"insertEmbed\", arguments)\r\n    },\r\n    showFormDialog: function(formConfig) {\r\n        return this._formDialog.show(formConfig)\r\n    },\r\n    formDialogOption: function(optionName, optionValue) {\r\n        return this._formDialog.popupOption.apply(this._formDialog, arguments)\r\n    },\r\n    focus: function() {\r\n        this.callBase();\r\n        this._applyQuillMethod(\"focus\")\r\n    },\r\n    blur: function() {\r\n        this._applyQuillMethod(\"blur\")\r\n    }\r\n});\r\nregisterComponent(\"dxHtmlEditor\", HtmlEditor);\r\nexport default HtmlEditor;\r\n"]},"metadata":{},"sourceType":"module"}