{"ast":null,"code":"import _classCallCheck from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\n/**\r\n * DevExtreme (esm/ui/diagram/diagram.items_option.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { extend } from \"../../core/utils/extend\";\nimport Component from \"../../core/component\";\nimport DataHelperMixin from \"../../data_helper\";\nvar ItemsOptionBase = Component.inherit({}).include(DataHelperMixin);\n\nvar ItemsOption = /*#__PURE__*/function (_ItemsOptionBase) {\n  _inherits(ItemsOption, _ItemsOptionBase);\n\n  var _super = _createSuper(ItemsOption);\n\n  function ItemsOption(diagramWidget) {\n    var _this;\n\n    _classCallCheck(this, ItemsOption);\n\n    _this = _super.call(this);\n    _this._diagramWidget = diagramWidget;\n\n    _this._resetCache();\n\n    return _this;\n  }\n\n  _createClass(ItemsOption, [{\n    key: \"_dataSourceChangedHandler\",\n    value: function _dataSourceChangedHandler(newItems, e) {\n      this._resetCache();\n\n      this._items = newItems.map(function (item) {\n        return extend(true, {}, item);\n      });\n      this._dataSourceItems = newItems.slice();\n\n      if (e && e.changes) {\n        var internalChanges = e.changes.filter(function (change) {\n          return change.internalChange;\n        });\n        var externalChanges = e.changes.filter(function (change) {\n          return !change.internalChange;\n        });\n\n        if (internalChanges.length) {\n          this._reloadContentByChanges(internalChanges, false);\n        }\n\n        if (externalChanges.length) {\n          this._reloadContentByChanges(externalChanges, true);\n        }\n      } else {\n        this._diagramWidget._onDataSourceChanged();\n      }\n    }\n  }, {\n    key: \"_dataSourceLoadingChangedHandler\",\n    value: function _dataSourceLoadingChangedHandler(isLoading) {\n      if (isLoading && !this._dataSource.isLoaded()) {\n        this._diagramWidget._showLoadingIndicator();\n      } else {\n        this._diagramWidget._hideLoadingIndicator();\n      }\n    }\n  }, {\n    key: \"_prepareData\",\n    value: function _prepareData(dataObj) {\n      for (var key in dataObj) {\n        if (!Object.prototype.hasOwnProperty.call(dataObj, key)) {\n          continue;\n        }\n\n        if (void 0 === dataObj[key]) {\n          dataObj[key] = null;\n        }\n      }\n\n      return dataObj;\n    }\n  }, {\n    key: \"insert\",\n    value: function insert(data, callback, errorCallback) {\n      var _this2 = this;\n\n      this._resetCache();\n\n      var store = this._getStore();\n\n      store.insert(this._prepareData(data)).done(function (data, key) {\n        store.push([{\n          type: \"insert\",\n          key: key,\n          data: data,\n          internalChange: true\n        }]);\n\n        if (callback) {\n          callback(data);\n        }\n\n        _this2._resetCache();\n      }).fail(function (error) {\n        if (errorCallback) {\n          errorCallback(error);\n        }\n\n        _this2._resetCache();\n      });\n    }\n  }, {\n    key: \"update\",\n    value: function update(key, data, callback, errorCallback) {\n      var store = this._getStore();\n\n      var storeKey = this._getStoreKey(store, key, data);\n\n      store.update(storeKey, this._prepareData(data)).done(function (data, key) {\n        store.push([{\n          type: \"update\",\n          key: key,\n          data: data,\n          internalChange: true\n        }]);\n\n        if (callback) {\n          callback(key, data);\n        }\n      }).fail(function (error) {\n        if (errorCallback) {\n          errorCallback(error);\n        }\n      });\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(key, data, callback, errorCallback) {\n      var _this3 = this;\n\n      this._resetCache();\n\n      var store = this._getStore();\n\n      var storeKey = this._getStoreKey(store, key, data);\n\n      store.remove(storeKey).done(function (key) {\n        store.push([{\n          type: \"remove\",\n          key: key,\n          internalChange: true\n        }]);\n\n        if (callback) {\n          callback(key);\n        }\n\n        _this3._resetCache();\n      }).fail(function (error) {\n        if (errorCallback) {\n          errorCallback(error);\n        }\n\n        _this3._resetCache();\n      });\n    }\n  }, {\n    key: \"findItem\",\n    value: function findItem(itemKey) {\n      if (!this._items) {\n        return null;\n      }\n\n      return this._getItemByKey(itemKey);\n    }\n  }, {\n    key: \"getItems\",\n    value: function getItems() {\n      return this._items;\n    }\n  }, {\n    key: \"hasItems\",\n    value: function hasItems() {\n      return !!this._items;\n    }\n  }, {\n    key: \"_reloadContentByChanges\",\n    value: function _reloadContentByChanges(changes, isExternalChanges) {\n      var _this4 = this;\n\n      changes = changes.map(function (change) {\n        return extend(change, {\n          internalKey: _this4._getInternalKey(change.key)\n        });\n      });\n\n      this._diagramWidget._reloadContentByChanges(changes, isExternalChanges);\n    }\n  }, {\n    key: \"_getItemByKey\",\n    value: function _getItemByKey(key) {\n      this._ensureCache();\n\n      var cache = this._cache;\n\n      var index = this._getIndexByKey(key);\n\n      return cache.items[index];\n    }\n  }, {\n    key: \"_getIndexByKey\",\n    value: function _getIndexByKey(key) {\n      this._ensureCache();\n\n      var cache = this._cache;\n\n      if (\"object\" === typeof key) {\n        for (var i = 0, length = cache.keys.length; i < length; i++) {\n          if (cache.keys[i] === key) {\n            return i;\n          }\n        }\n      } else {\n        var keySet = cache.keySet || cache.keys.reduce(function (accumulator, key, index) {\n          accumulator[key] = index;\n          return accumulator;\n        }, {});\n\n        if (!cache.keySet) {\n          cache.keySet = keySet;\n        }\n\n        return keySet[key];\n      }\n\n      return -1;\n    }\n  }, {\n    key: \"_ensureCache\",\n    value: function _ensureCache() {\n      var cache = this._cache;\n\n      if (!cache.keys) {\n        cache.keys = [];\n        cache.items = [];\n\n        this._fillCache(cache, this._items);\n      }\n    }\n  }, {\n    key: \"_fillCache\",\n    value: function _fillCache(cache, items) {\n      var _this5 = this;\n\n      if (!items || !items.length) {\n        return;\n      }\n\n      var keyExpr = this._getKeyExpr();\n\n      if (keyExpr) {\n        items.forEach(function (item) {\n          cache.keys.push(keyExpr(item));\n          cache.items.push(item);\n        });\n      }\n\n      var itemsExpr = this._getItemsExpr();\n\n      if (itemsExpr) {\n        items.forEach(function (item) {\n          return _this5._fillCache(cache, itemsExpr(item));\n        });\n      }\n\n      var containerChildrenExpr = this._getContainerChildrenExpr();\n\n      if (containerChildrenExpr) {\n        items.forEach(function (item) {\n          return _this5._fillCache(cache, containerChildrenExpr(item));\n        });\n      }\n    }\n  }, {\n    key: \"_getKeyExpr\",\n    value: function _getKeyExpr() {\n      throw \"Not Implemented\";\n    }\n  }, {\n    key: \"_getItemsExpr\",\n    value: function _getItemsExpr() {}\n  }, {\n    key: \"_getContainerChildrenExpr\",\n    value: function _getContainerChildrenExpr() {}\n  }, {\n    key: \"_initDataSource\",\n    value: function _initDataSource() {\n      _get(_getPrototypeOf(ItemsOption.prototype), \"_initDataSource\", this).call(this);\n\n      this._dataSource && this._dataSource.paginate(false);\n    }\n  }, {\n    key: \"_dataSourceOptions\",\n    value: function _dataSourceOptions() {\n      return {\n        paginate: false\n      };\n    }\n  }, {\n    key: \"_getStore\",\n    value: function _getStore() {\n      return this._dataSource && this._dataSource.store();\n    }\n  }, {\n    key: \"_getStoreKey\",\n    value: function _getStoreKey(store, internalKey, data) {\n      var storeKey = store.keyOf(data);\n\n      if (storeKey === data) {\n        var keyExpr = this._getKeyExpr();\n\n        this._dataSourceItems.forEach(function (item) {\n          if (keyExpr(item) === internalKey) {\n            storeKey = item;\n          }\n        });\n      }\n\n      return storeKey;\n    }\n  }, {\n    key: \"_getInternalKey\",\n    value: function _getInternalKey(storeKey) {\n      if (\"object\" === typeof storeKey) {\n        var keyExpr = this._getKeyExpr();\n\n        return keyExpr(storeKey);\n      }\n\n      return storeKey;\n    }\n  }, {\n    key: \"_resetCache\",\n    value: function _resetCache() {\n      this._cache = {};\n    }\n  }]);\n\n  return ItemsOption;\n}(ItemsOptionBase);\n\nexport default ItemsOption;","map":{"version":3,"sources":["C:/Users/user/source/repos/ReportingPortal/6.3.0/angular/node_modules/devextreme/esm/ui/diagram/diagram.items_option.js"],"names":["extend","Component","DataHelperMixin","ItemsOptionBase","inherit","include","ItemsOption","diagramWidget","_diagramWidget","_resetCache","newItems","e","_items","map","item","_dataSourceItems","slice","changes","internalChanges","filter","change","internalChange","externalChanges","length","_reloadContentByChanges","_onDataSourceChanged","isLoading","_dataSource","isLoaded","_showLoadingIndicator","_hideLoadingIndicator","dataObj","key","Object","prototype","hasOwnProperty","call","data","callback","errorCallback","store","_getStore","insert","_prepareData","done","push","type","fail","error","storeKey","_getStoreKey","update","remove","itemKey","_getItemByKey","isExternalChanges","internalKey","_getInternalKey","_ensureCache","cache","_cache","index","_getIndexByKey","items","i","keys","keySet","reduce","accumulator","_fillCache","keyExpr","_getKeyExpr","forEach","itemsExpr","_getItemsExpr","containerChildrenExpr","_getContainerChildrenExpr","paginate","keyOf"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/diagram/diagram.items_option.js)\r\n * Version: 21.1.3\r\n * Build date: Tue May 18 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport Component from \"../../core/component\";\r\nimport DataHelperMixin from \"../../data_helper\";\r\nvar ItemsOptionBase = Component.inherit({}).include(DataHelperMixin);\r\nclass ItemsOption extends ItemsOptionBase {\r\n    constructor(diagramWidget) {\r\n        super();\r\n        this._diagramWidget = diagramWidget;\r\n        this._resetCache()\r\n    }\r\n    _dataSourceChangedHandler(newItems, e) {\r\n        this._resetCache();\r\n        this._items = newItems.map(item => extend(true, {}, item));\r\n        this._dataSourceItems = newItems.slice();\r\n        if (e && e.changes) {\r\n            var internalChanges = e.changes.filter(change => change.internalChange);\r\n            var externalChanges = e.changes.filter(change => !change.internalChange);\r\n            if (internalChanges.length) {\r\n                this._reloadContentByChanges(internalChanges, false)\r\n            }\r\n            if (externalChanges.length) {\r\n                this._reloadContentByChanges(externalChanges, true)\r\n            }\r\n        } else {\r\n            this._diagramWidget._onDataSourceChanged()\r\n        }\r\n    }\r\n    _dataSourceLoadingChangedHandler(isLoading) {\r\n        if (isLoading && !this._dataSource.isLoaded()) {\r\n            this._diagramWidget._showLoadingIndicator()\r\n        } else {\r\n            this._diagramWidget._hideLoadingIndicator()\r\n        }\r\n    }\r\n    _prepareData(dataObj) {\r\n        for (var key in dataObj) {\r\n            if (!Object.prototype.hasOwnProperty.call(dataObj, key)) {\r\n                continue\r\n            }\r\n            if (void 0 === dataObj[key]) {\r\n                dataObj[key] = null\r\n            }\r\n        }\r\n        return dataObj\r\n    }\r\n    insert(data, callback, errorCallback) {\r\n        this._resetCache();\r\n        var store = this._getStore();\r\n        store.insert(this._prepareData(data)).done((data, key) => {\r\n            store.push([{\r\n                type: \"insert\",\r\n                key: key,\r\n                data: data,\r\n                internalChange: true\r\n            }]);\r\n            if (callback) {\r\n                callback(data)\r\n            }\r\n            this._resetCache()\r\n        }).fail(error => {\r\n            if (errorCallback) {\r\n                errorCallback(error)\r\n            }\r\n            this._resetCache()\r\n        })\r\n    }\r\n    update(key, data, callback, errorCallback) {\r\n        var store = this._getStore();\r\n        var storeKey = this._getStoreKey(store, key, data);\r\n        store.update(storeKey, this._prepareData(data)).done((data, key) => {\r\n            store.push([{\r\n                type: \"update\",\r\n                key: key,\r\n                data: data,\r\n                internalChange: true\r\n            }]);\r\n            if (callback) {\r\n                callback(key, data)\r\n            }\r\n        }).fail(error => {\r\n            if (errorCallback) {\r\n                errorCallback(error)\r\n            }\r\n        })\r\n    }\r\n    remove(key, data, callback, errorCallback) {\r\n        this._resetCache();\r\n        var store = this._getStore();\r\n        var storeKey = this._getStoreKey(store, key, data);\r\n        store.remove(storeKey).done(key => {\r\n            store.push([{\r\n                type: \"remove\",\r\n                key: key,\r\n                internalChange: true\r\n            }]);\r\n            if (callback) {\r\n                callback(key)\r\n            }\r\n            this._resetCache()\r\n        }).fail(error => {\r\n            if (errorCallback) {\r\n                errorCallback(error)\r\n            }\r\n            this._resetCache()\r\n        })\r\n    }\r\n    findItem(itemKey) {\r\n        if (!this._items) {\r\n            return null\r\n        }\r\n        return this._getItemByKey(itemKey)\r\n    }\r\n    getItems() {\r\n        return this._items\r\n    }\r\n    hasItems() {\r\n        return !!this._items\r\n    }\r\n    _reloadContentByChanges(changes, isExternalChanges) {\r\n        changes = changes.map(change => extend(change, {\r\n            internalKey: this._getInternalKey(change.key)\r\n        }));\r\n        this._diagramWidget._reloadContentByChanges(changes, isExternalChanges)\r\n    }\r\n    _getItemByKey(key) {\r\n        this._ensureCache();\r\n        var cache = this._cache;\r\n        var index = this._getIndexByKey(key);\r\n        return cache.items[index]\r\n    }\r\n    _getIndexByKey(key) {\r\n        this._ensureCache();\r\n        var cache = this._cache;\r\n        if (\"object\" === typeof key) {\r\n            for (var i = 0, length = cache.keys.length; i < length; i++) {\r\n                if (cache.keys[i] === key) {\r\n                    return i\r\n                }\r\n            }\r\n        } else {\r\n            var keySet = cache.keySet || cache.keys.reduce((accumulator, key, index) => {\r\n                accumulator[key] = index;\r\n                return accumulator\r\n            }, {});\r\n            if (!cache.keySet) {\r\n                cache.keySet = keySet\r\n            }\r\n            return keySet[key]\r\n        }\r\n        return -1\r\n    }\r\n    _ensureCache() {\r\n        var cache = this._cache;\r\n        if (!cache.keys) {\r\n            cache.keys = [];\r\n            cache.items = [];\r\n            this._fillCache(cache, this._items)\r\n        }\r\n    }\r\n    _fillCache(cache, items) {\r\n        if (!items || !items.length) {\r\n            return\r\n        }\r\n        var keyExpr = this._getKeyExpr();\r\n        if (keyExpr) {\r\n            items.forEach(item => {\r\n                cache.keys.push(keyExpr(item));\r\n                cache.items.push(item)\r\n            })\r\n        }\r\n        var itemsExpr = this._getItemsExpr();\r\n        if (itemsExpr) {\r\n            items.forEach(item => this._fillCache(cache, itemsExpr(item)))\r\n        }\r\n        var containerChildrenExpr = this._getContainerChildrenExpr();\r\n        if (containerChildrenExpr) {\r\n            items.forEach(item => this._fillCache(cache, containerChildrenExpr(item)))\r\n        }\r\n    }\r\n    _getKeyExpr() {\r\n        throw \"Not Implemented\"\r\n    }\r\n    _getItemsExpr() {}\r\n    _getContainerChildrenExpr() {}\r\n    _initDataSource() {\r\n        super._initDataSource();\r\n        this._dataSource && this._dataSource.paginate(false)\r\n    }\r\n    _dataSourceOptions() {\r\n        return {\r\n            paginate: false\r\n        }\r\n    }\r\n    _getStore() {\r\n        return this._dataSource && this._dataSource.store()\r\n    }\r\n    _getStoreKey(store, internalKey, data) {\r\n        var storeKey = store.keyOf(data);\r\n        if (storeKey === data) {\r\n            var keyExpr = this._getKeyExpr();\r\n            this._dataSourceItems.forEach(item => {\r\n                if (keyExpr(item) === internalKey) {\r\n                    storeKey = item\r\n                }\r\n            })\r\n        }\r\n        return storeKey\r\n    }\r\n    _getInternalKey(storeKey) {\r\n        if (\"object\" === typeof storeKey) {\r\n            var keyExpr = this._getKeyExpr();\r\n            return keyExpr(storeKey)\r\n        }\r\n        return storeKey\r\n    }\r\n    _resetCache() {\r\n        this._cache = {}\r\n    }\r\n}\r\nexport default ItemsOption;\r\n"]},"metadata":{},"sourceType":"module"}